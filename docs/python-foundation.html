<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Ujaval Gandhi" />


<title>Python Foundation for Spatial Analysis (Course Material)</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Courses</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="http://spatialthoughts.com">Back to Main Site</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Python Foundation for Spatial Analysis (Course Material)</h1>
<h3 class="subtitle">A gentle introduction to Python programming with a focus on spatial data.</h3>
<h4 class="author">Ujaval Gandhi</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#get-the-data-package">Get the Data Package</a></li>
<li><a href="#installation-and-setting-up-the-environment">Installation and Setting up the Environment</a></li>
<li><a href="#using-jupyter-notebooks">Using Jupyter Notebooks</a></li>
<li><a href="#hello-world">Hello World</a></li>
<li><a href="#variables">Variables</a><ul>
<li><a href="#strings">Strings</a></li>
<li><a href="#numbers">Numbers</a></li>
<li><a href="#exercise">Exercise</a></li>
</ul></li>
<li><a href="#data-structures">Data Structures</a><ul>
<li><a href="#tuples">Tuples</a></li>
<li><a href="#lists">Lists</a></li>
<li><a href="#sets">Sets</a></li>
<li><a href="#dictionaries">Dictionaries</a></li>
<li><a href="#exercise-1">Exercise</a></li>
</ul></li>
<li><a href="#string-operations">String Operations</a><ul>
<li><a href="#escaping-characters">Escaping characters</a></li>
<li><a href="#printing-strings">Printing Strings</a></li>
<li><a href="#exercise-2">Exercise</a></li>
</ul></li>
<li><a href="#loops-and-conditionals">Loops and Conditionals</a><ul>
<li><a href="#for-loops">For Loops</a></li>
</ul></li>
<li><a href="#conditionals">Conditionals</a><ul>
<li><a href="#control-statements">Control Statements</a></li>
<li><a href="#exercise-3">Exercise</a></li>
</ul></li>
<li><a href="#functions">Functions</a><ul>
<li><a href="#exercise-4">Exercise</a></li>
</ul></li>
<li><a href="#the-python-standard-library">The Python Standard Library</a><ul>
<li><a href="#calculating-distance">Calculating Distance</a></li>
<li><a href="#discover-python-easter-eggs">Discover Python Easter Eggs</a></li>
<li><a href="#exercise-5">Exercise</a></li>
</ul></li>
<li><a href="#third-party-modules">Third-party Modules</a><ul>
<li><a href="#installing-third-party-libraries">Installing third-party libraries</a></li>
<li><a href="#calculating-distance-1">Calculating Distance</a></li>
<li><a href="#exercise-6">Exercise</a></li>
</ul></li>
<li><a href="#reading-files">Reading Files</a><ul>
<li><a href="#exercise-7">Exercise</a></li>
</ul></li>
<li><a href="#reading-csv-files">Reading CSV Files</a><ul>
<li><a href="#using-enumerate-function">Using <code>enumerate()</code> function</a></li>
<li><a href="#using-with-statement">Using <code>with</code> statement</a></li>
<li><a href="#filtering-rows">Filtering rows</a></li>
<li><a href="#calculating-distance-2">Calculating distance</a></li>
<li><a href="#writing-files">Writing files</a></li>
<li><a href="#exercise-8">Exercise</a></li>
</ul></li>
<li><a href="#using-web-apis">Using Web APIs</a><ul>
<li><a href="#understanding-json-and-geojson">Understanding JSON and GeoJSON</a></li>
<li><a href="#the-requests-module">The <code>requests</code> module</a></li>
<li><a href="#calculating-distance-using-openrouteservice-api">Calculating Distance using OpenRouteService API</a></li>
<li><a href="#api-rate-limiting">API Rate Limiting</a><ul>
<li><a href="#the-time-module">The <code>time</code> module</a></li>
</ul></li>
<li><a href="#exercise-9">Exercise</a></li>
</ul></li>
<li><a href="#working-with-pandas">Working with Pandas</a><ul>
<li><a href="#reading-files-1">Reading Files</a></li>
<li><a href="#filtering-data">Filtering Data</a></li>
<li><a href="#performing-calculations">Performing calculations</a></li>
<li><a href="#exercise-10">Exercise</a></li>
</ul></li>
<li><a href="#working-with-geopandas">Working with Geopandas</a><ul>
<li><a href="#reading-spatial-data">Reading Spatial Data</a></li>
<li><a href="#filtering-data-1">Filtering Data</a></li>
<li><a href="#working-with-projections">Working with Projections</a></li>
<li><a href="#performing-spatial-joins">Performing Spatial joins</a></li>
<li><a href="#group-statistics">Group Statistics</a></li>
<li><a href="#exercise-11">Exercise</a></li>
</ul></li>
<li><a href="#creating-spatial-data">Creating Spatial Data</a><ul>
<li><a href="#reading-tab-delimited-files">Reading Tab-Delimited Files</a></li>
<li><a href="#filtering-data-2">Filtering Data</a></li>
<li><a href="#creating-geometries">Creating Geometries</a></li>
<li><a href="#writing-files-1">Writing Files</a></li>
<li><a href="#exercise-12">Exercise</a></li>
</ul></li>
<li><a href="#introduction-to-numpy">Introduction to NumPy</a><ul>
<li><a href="#arrays">Arrays</a></li>
<li><a href="#array-operations">Array Operations</a></li>
<li><a href="#exercise-13">Exercise</a></li>
</ul></li>
<li><a href="#working-with-rasterio">Working with RasterIO</a><ul>
<li><a href="#reading-raster-data">Reading Raster Data</a></li>
<li><a href="#merging-datasets">Merging Datasets</a></li>
<li><a href="#writing-raster-data">Writing Raster Data</a></li>
<li><a href="#exercise-14">Exercise</a></li>
</ul></li>
<li><a href="#writing-standalone-python-scripts">Writing Standalone Python Scripts</a><ul>
<li><a href="#get-a-text-editor">Get a Text Editor</a></li>
<li><a href="#writing-a-script">Writing a Script</a></li>
<li><a href="#executing-a-script">Executing a Script</a><ul>
<li><a href="#windows">Windows</a></li>
<li><a href="#mac-and-linux">Mac and Linux</a></li>
</ul></li>
</ul></li>
<li><a href="#what-next">What next?</a><ul>
<li><a href="#do-a-project">Do a Project</a></li>
<li><a href="#keep-learning">Keep Learning</a></li>
</ul></li>
<li><a href="#data-credits">Data Credits</a></li>
<li><a href="#license">License</a></li>
</ul>
</div>


<hr />
<p><img src="images/spatial_thoughts_logo.png" width="250pt" style="display: block; margin: auto;" /></p>
<p><strong>This course is also offered as an online class. Visit <a href="https://spatialthoughts.com/events/">www.spatialthoughts.com/events</a> to know details of upcoming sessions. You may also sign up for <a href="https://mailchi.mp/1d44f6c0c955/spatialthoughts">my mailing list</a> to know when new sessions are scheduled.</strong></p>
<p><em>Want to work through the material on your own?</em> <a href="https://gumroad.com/l/RTkk">Purchase the data package</a>.</p>
<hr />

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This class covers Python from the very basics. Suitable for GIS practitioners with no programming background or python knowledge. The course will introduce participants to basic programming concepts, libraries for spatial analysis, geospatial APIs and techniques for building spatial data processing pipelines.</p>
</div>
<div id="get-the-data-package" class="section level1">
<h1>Get the Data Package</h1>
<p>The code examples in this class use a variety of datasets. All the required datasets and Jupyter notebooks are supplied to you in the <code>python_foundation.zip</code> file. Unzip this file to a directory - preferably to the <code>&lt;home folder&gt;/Downloads/python_foundation/</code> folder.</p>
</div>
<div id="installation-and-setting-up-the-environment" class="section level1">
<h1>Installation and Setting up the Environment</h1>
<p>There are many ways to install Python on your system. Many operating systems comes with a Python distribution built-in too. If you use software such as QGIS - it comes with its own version of Python. Working on Python projects typically require installing third-party packages (i.e. tools). As these packages have different dependencies - they often cause conflicts and errors due to different versions of Python on your system.</p>
<p>An easy and reliable way to get a Python installation on your system is via <a href="https://www.anaconda.com/">Anaconda</a>. For this course, we will use the Anaconda3 Individual Edition to install Python and required spatial analysis packages.</p>
<blockquote>
<p>Many Python tool names have references to the reptile world. The default Python package manager is called <a href="https://pypi.org/project/pip/">Pip</a> which references the process of hatching eggs. Interestingly, the naming of the Python language itself had <a href="https://en.wikipedia.org/wiki/Guido_van_Rossum#Python">nothing to do with reptiles</a>.</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><a href="https://www.anaconda.com/products/individual">Download the Anaconda Installer</a> for Python 3.7 (or a higher version) for your operating system. Once downloaded, double click the installer and install it into the default suggested directory. Select an install for <em>Just Me</em> and <strong>use default settings</strong>. <em>Note: If your username has spaces, or non-English characters, it causes problems. In that case, you can install it to a path such as <code>C:\anaconda</code>.</em></li>
</ol>
<p><img src="images/python_foundation/conda1.png" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Once installed, launch the <em>Anaconda Navigator</em> program. It is a good practice to create a new <em>environment</em> for each of your Python projects. An environment is a space where you will install required packages. Many packages may contain conflicting requirements which could prevent them all being installed into a single environment. Having a separate environment isolates your project from such problems. Click on the <em>Environments</em> tab.</li>
</ol>
<blockquote>
<p>Linux users can open a terminal and type <code>anaconda-navigator</code> to launch the program.</p>
</blockquote>
<p><img src="images/python_foundation/conda2.png" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Click the <em>+ Create</em> button and name the environment as <code>python_foundation</code>. Click <em>Create</em>.</li>
</ol>
<p><img src="images/python_foundation/conda3.png" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Once created, click the <em>Channels</em> button. A channel is a repository where packages are hosted. The default channel is good for most purposes. But some packages we require for this class are not available in the default channel, so we need to add another channel. In the <em>Manage channels</em> dialog, click <em>Add</em> and enter <code>conda-forge</code>. Press <em>Enter</em>.</li>
</ol>
<blockquote>
<p>Learn more about <a href="https://conda-forge.org/docs/user/introduction.html">conda-forge</a></p>
</blockquote>
<p><img src="images/python_foundation/conda4.png" style="display: block; margin: auto;" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Click the <em>Update Channels</em> button.</li>
</ol>
<p><img src="images/python_foundation/conda5.png" style="display: block; margin: auto;" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Once the update is done, search for the package <code>geopandas</code>. This is a package that allows you to work with vector geospatial data in Python. Select the check-box next to the first result and click <em>Apply</em> to install the package with all its dependencies.</li>
</ol>
<p><img src="images/python_foundation/conda6.png" style="display: block; margin: auto;" /></p>
<ol start="7" style="list-style-type: decimal">
<li>Similarly, search and install the following packages</li>
</ol>
<ul>
<li><code>geopy</code></li>
<li><code>rasterio</code></li>
<li><code>matplotlib</code></li>
</ul>
<p><img src="images/python_foundation/conda7.png" style="display: block; margin: auto;" /></p>
<ol start="8" style="list-style-type: decimal">
<li>Switch to the <em>Home</em> tab. Ensure that you have the <em>python_foundation</em> environment selected. We will now install some programs which allow us to write and execute Python scripts. From the home screen, install the <code>JupyterLab</code> application. Windows users may optionally install the <code>CMD.exe prompt</code> application.</li>
</ol>
<p><img src="images/python_foundation/conda8.png" style="display: block; margin: auto;" /></p>
<ol start="9" style="list-style-type: decimal">
<li>After the installation completes, click <em>Launch</em> button for the <em>JupyterLab</em> application. JupyterLab is a web application that allows you to write, document and run Python code. It allow you to interactively run small bits of code and see the results. It also support a variety of output formats such as charts or maps - making it an ideal platform for data science projects. The name Jupyter comes from the 3 primary programming languages it supports - Julia, Python and R. We will be using Jupyter notebooks for all exercises in this course.</li>
</ol>
<blockquote>
<p>Linux users can open a terminal and first switch to the correct environment using the command <code>conda activate python_foundation</code>. After that, JupyterLab can be opened using the <code>jupyter-lab</code> command.</p>
</blockquote>
<p><img src="images/python_foundation/conda9.png" style="display: block; margin: auto;" /></p>
<ol start="10" style="list-style-type: decimal">
<li>A new browser tab will open with an instance of JupterLab. Click the <em>Python 3</em> button under <em>Notebooks</em>.</li>
</ol>
<p><img src="images/python_foundation/conda10.png" style="display: block; margin: auto;" /></p>
<ol start="11" style="list-style-type: decimal">
<li>Enter the following statements in the first cell and click the <em>Run</em> button. <strong>If nothing happens - it means your installation was successful!</strong>. If you get an <em>ImportError</em>, repeat the installation steps carefully again.</li>
</ol>
<pre><code>import geopandas
import geopy
import rasterio</code></pre>
<p><img src="images/python_foundation/conda11.png" style="display: block; margin: auto;" /></p>
</div>
<div id="using-jupyter-notebooks" class="section level1">
<h1>Using Jupyter Notebooks</h1>
<p>Your class data package contain multiple Jupyter notebooks containing code and exercises for this class.</p>
<ol style="list-style-type: decimal">
<li>Launch the <em>Anaconda Navigator</em> program. Ensure that you have the <em>python_foundation</em> environment selected. click <em>Launch</em> button for the <em>JupyterLab</em> application. It will open your Web Browser and load the application in a new tab. From the left-hand panel, navigate to the directory where you extracted the data package.</li>
</ol>
<p><img src="images/python_foundation/setup1.png" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Jupyter notebooks have a <code>.ipynb</code> extensions. Double-click on a notebook file to open it. Code in the notebook is executed cell-by-cell. You can select a cell and click the <em>Run</em> button to execute the code and see the output.</li>
</ol>
<p><img src="images/python_foundation/setup2.png" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>At the end of each notebook, you will find an exercise. Before adding a new cell and attempting to complete the exercise, make sure you go to <strong>Run → Run All Cells</strong> to execute all the code in the notebook. Doing this will ensure all the required variables are avalable to you to use in the exervise.</li>
</ol>
<p><img src="images/python_foundation/setup3.png" style="display: block; margin: auto;" /> </p>
<hr />
<p>Open the notebook named <code>00_hello_world.ipynb</code>.</p>
<hr />
</div>
<div id="hello-world" class="section level1">
<h1>Hello World</h1>
<p>When learning a new programming language, it is customary to first learn how to print ‘Hello World!’. While a bit quirky, it is a useful first step to know how to send input to the program and where to see the output. In Python, you can use the built-in <code>print()</code> function to print the greeting <code>&quot;Hello World!&quot;</code></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(<span class="st">&#39;Hello World!&#39;</span>)</code></pre></div>
<pre><code>Hello World!</code></pre>
<hr />

<p>Open the notebook named <code>01_variables.ipynb</code>.</p>
<hr />
</div>
<div id="variables" class="section level1">
<h1>Variables</h1>
<div id="strings" class="section level2">
<h2>Strings</h2>
<p>A string is a sequence of letters, numbers, and punctuation marks - or commonly known as <strong>text</strong></p>
<p>In Python you can create a string by typing letters between single or double quotation marks.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">city <span class="op">=</span> <span class="st">&#39;San Fransico&#39;</span>
state <span class="op">=</span> <span class="st">&#39;California&#39;</span>
<span class="bu">print</span>(city, state)</code></pre></div>
<pre><code>San Fransico California</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(city <span class="op">+</span> state)</code></pre></div>
<pre><code>San FransicoCalifornia</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(city <span class="op">+</span> <span class="st">&#39;,&#39;</span> <span class="op">+</span> state)</code></pre></div>
<pre><code>San Fransico,California</code></pre>
</div>
<div id="numbers" class="section level2">
<h2>Numbers</h2>
<p>Python can handle several types of numbers, but the two most common are:</p>
<ul>
<li><strong>int</strong>, which represents integer values like 100, and</li>
<li><strong>float</strong>, which represents numbers that have a fraction part, like 0.5</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">population <span class="op">=</span> <span class="dv">881549</span>
latitude <span class="op">=</span> <span class="fl">37.7739</span>
longitude <span class="op">=</span> <span class="op">-</span><span class="fl">121.5687</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(<span class="bu">type</span>(population))</code></pre></div>
<pre><code>&lt;class &#39;int&#39;&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(<span class="bu">type</span>(latitude))</code></pre></div>
<pre><code>&lt;class &#39;float&#39;&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">elevation_feet <span class="op">=</span> <span class="dv">934</span>
elevation_meters <span class="op">=</span> elevation_feet <span class="op">*</span> <span class="fl">0.3048</span>
<span class="bu">print</span>(elevation_meters)</code></pre></div>
<pre><code>284.6832</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">area_sqmi <span class="op">=</span> <span class="fl">46.89</span>
density <span class="op">=</span> population <span class="op">/</span> area_sqmi
<span class="bu">print</span>(density)</code></pre></div>
<pre><code>18800.362550650458</code></pre>
</div>
<div id="exercise" class="section level2">
<h2>Exercise</h2>
<p>We calculated the population density in number of people per square mile. Calculate and print the density in number of people per square kilometers.</p>
<ul>
<li>Hint1: 1 mile = 1.60934 kilometers</li>
<li>Hint2: To calculate exponential of a number in Python, you use the ** notation. x² is written as x**2</li>
</ul>
<p>Add the code in the cell below and run it. The output should be 7258.8966</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">population <span class="op">=</span> <span class="dv">881549</span>
area_sqmi <span class="op">=</span> <span class="fl">46.89</span>

<span class="co"># Remove this line and add code here</span></code></pre></div>
<hr />

<p>Open the notebook named <code>02_data_structures.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="data-structures" class="section level1">
<h1>Data Structures</h1>
<div id="tuples" class="section level2">
<h2>Tuples</h2>
<p>A <em>tuple</em> is a sequence of objects. It can have any number of objects inside. In Python tuples are written with round brackets <strong>()</strong>.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">latitude <span class="op">=</span> <span class="fl">37.7739</span>
longitude <span class="op">=</span> <span class="op">-</span><span class="fl">121.5687</span>
coordinates <span class="op">=</span> (latitude, longitude)
<span class="bu">print</span>(coordinates)</code></pre></div>
<pre><code>(37.7739, -121.5687)</code></pre>
<p>You can access each item by its position, i.e. <em>index</em>. In programming, the counting starts from 0. So the first item has an index of 0, the second item an index of 1 and so now. The index has to be put inside square brackets <strong>[]</strong>.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">y <span class="op">=</span> coordinates[<span class="dv">0</span>]
x <span class="op">=</span> coordinates[<span class="dv">1</span>]
<span class="bu">print</span>(x, y)</code></pre></div>
<pre><code>-121.5687 37.7739</code></pre>
</div>
<div id="lists" class="section level2">
<h2>Lists</h2>
<p>A <strong>list</strong> is similar to a tuple - but with a key difference. With tuples, once created, they cannot be changed, i.e. they are immutable. But lists are mutable. You can add, delete or change elements within a list. In Python, lists are written with square brackets <strong>[]</strong></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">cities <span class="op">=</span> [<span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;Los Angeles&#39;</span>, <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]
<span class="bu">print</span>(cities)</code></pre></div>
<pre><code>[&#39;San Francisco&#39;, &#39;Los Angeles&#39;, &#39;New York&#39;, &#39;Atlanta&#39;]</code></pre>
<p>You can access the elements from a list using index the same way as tuples.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(cities[<span class="dv">0</span>])</code></pre></div>
<pre><code>San Francisco</code></pre>
<p>You can call <code>len()</code> function with any Python object and it will calculates the size of the object.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(<span class="bu">len</span>(cities))</code></pre></div>
<pre><code>4</code></pre>
<p>We can add items to the list using the <code>append()</code> method</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">cities.append(<span class="st">&#39;Boston&#39;</span>)
<span class="bu">print</span>(cities)</code></pre></div>
<pre><code>[&#39;San Francisco&#39;, &#39;Los Angeles&#39;, &#39;New York&#39;, &#39;Atlanta&#39;, &#39;Boston&#39;]</code></pre>
<p>As lists are <em>mutable</em>, you will see that the size of the list has now changed</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(<span class="bu">len</span>(cities))</code></pre></div>
<pre><code>5</code></pre>
<p>Another useful method for lists is <code>sort()</code> - which can sort the elements in a list.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">cities.sort()
<span class="bu">print</span>(cities)</code></pre></div>
<pre><code>[&#39;Atlanta&#39;, &#39;Boston&#39;, &#39;Los Angeles&#39;, &#39;New York&#39;, &#39;San Francisco&#39;]</code></pre>
<p>The default sorting is in <em>ascending</em> order. If we wanted to sort the list in a <em>decending</em> order, we can call the function with <code>reverse=True</code></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">cities.sort(reverse<span class="op">=</span><span class="va">True</span>)
<span class="bu">print</span>(cities)</code></pre></div>
<pre><code>[&#39;San Francisco&#39;, &#39;New York&#39;, &#39;Los Angeles&#39;, &#39;Boston&#39;, &#39;Atlanta&#39;]</code></pre>
</div>
<div id="sets" class="section level2">
<h2>Sets</h2>
<p>Sets are like lists, but with some interesting properties. Mainly that they contain only unique values. It also allows for <em>set operations</em> - such as <em>intersection</em>, <em>union</em> and <em>difference</em>. In practice, the sets are typically created from lists.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">capitals <span class="op">=</span> [<span class="st">&#39;Sacramento&#39;</span>, <span class="st">&#39;Boston&#39;</span>, <span class="st">&#39;Austin&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]
capitals_set <span class="op">=</span> <span class="bu">set</span>(capitals)
cities_set <span class="op">=</span> <span class="bu">set</span>(cities)

capital_cities <span class="op">=</span> capitals_set.intersection(cities_set)
<span class="bu">print</span>(capital_cities)</code></pre></div>
<pre><code>{&#39;Atlanta&#39;, &#39;Boston&#39;}</code></pre>
<p>Sets are also useful in finding unique elements in a list. Let’s merge the two lists using the <code>extend()</code> method. The resulting list will have duplicate elements. Creating a set from the list removes the duplicate elements.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">cities.extend(capitals)
<span class="bu">print</span>(cities)
<span class="bu">print</span>(<span class="bu">set</span>(cities))</code></pre></div>
<pre><code>[&#39;San Francisco&#39;, &#39;New York&#39;, &#39;Los Angeles&#39;, &#39;Boston&#39;, &#39;Atlanta&#39;, &#39;Sacramento&#39;, &#39;Boston&#39;, &#39;Austin&#39;, &#39;Atlanta&#39;]
{&#39;Los Angeles&#39;, &#39;New York&#39;, &#39;Sacramento&#39;, &#39;San Francisco&#39;, &#39;Austin&#39;, &#39;Atlanta&#39;, &#39;Boston&#39;}</code></pre>
</div>
<div id="dictionaries" class="section level2">
<h2>Dictionaries</h2>
<p>In Python dictionaries are written with curly brackets <strong>{}</strong>. Dictionaries have <em>keys</em> and <em>values</em>. With lists, we can access each element by its index. But a dictionary makes it easy to access the element by name. Keys and values are separated by a colon <strong>:</strong>.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">data <span class="op">=</span> {<span class="st">&#39;city&#39;</span>: <span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;population&#39;</span>: <span class="dv">881549</span>, <span class="st">&#39;coordinates&#39;</span>: (<span class="op">-</span><span class="fl">122.4194</span>, <span class="fl">37.7749</span>) }
<span class="bu">print</span>(data)</code></pre></div>
<pre><code>{&#39;city&#39;: &#39;San Francisco&#39;, &#39;population&#39;: 881549, &#39;coordinates&#39;: (-122.4194, 37.7749)}</code></pre>
<p>You can access an item of a dictionary by referring to its key name, inside square brackets.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(data[<span class="st">&#39;city&#39;</span>])</code></pre></div>
<pre><code>San Francisco</code></pre>
</div>
<div id="exercise-1" class="section level2">
<h2>Exercise</h2>
<p>From the dictionary below, how do you access the latitude and longitude values? print the latitude and longitude of new york city by extracting it from the dictionary below.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">nyc_data <span class="op">=</span> {<span class="st">&#39;city&#39;</span>: <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;population&#39;</span>: <span class="dv">8175133</span>, <span class="st">&#39;coordinates&#39;</span>: (<span class="fl">40.661</span>, <span class="op">-</span><span class="fl">73.944</span>) }</code></pre></div>
<hr />

<p>Open the notebook named <code>03_string_operations.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="string-operations" class="section level1">
<h1>String Operations</h1>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">city <span class="op">=</span> <span class="st">&#39;San Francisco&#39;</span>
<span class="bu">print</span>(<span class="bu">len</span>(city))</code></pre></div>
<pre><code>13</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(city.split())</code></pre></div>
<pre><code>[&#39;San&#39;, &#39;Francisco&#39;]</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(city.upper())</code></pre></div>
<pre><code>SAN FRANCISCO</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">city[<span class="dv">0</span>]</code></pre></div>
<pre><code>&#39;S&#39;</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">city[<span class="op">-</span><span class="dv">1</span>]</code></pre></div>
<pre><code>&#39;o&#39;</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">city[<span class="dv">0</span>:<span class="dv">3</span>]</code></pre></div>
<pre><code>&#39;San&#39;</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">city[<span class="dv">4</span>:]</code></pre></div>
<pre><code>&#39;Francisco&#39;</code></pre>
<div id="escaping-characters" class="section level2">
<h2>Escaping characters</h2>
<p>Certain characters are special since they are by Python language itself. For example, the quote character <strong>’</strong> is used to define a string. What do you do if your string contains a quote character?</p>
<p>In Python strings, the backslash <strong>\</strong> is a special character, also called the <strong>escape</strong> character. Prefixing any character with a backslash makes it an ordinary character. (Hint: Prefixing a backslash with a backshalsh makes it ordinary too!)</p>
<p>It is also used for representing certain whitespace characters, \n is a newline, \t is a tab etc.</p>
<p>Remove the # from the cell below and run it.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># my_string = &#39;It&#39;s a beautiful day!&#39;</span></code></pre></div>
<p>We can fix the error by espacing the single quote within the string.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_string <span class="op">=</span> <span class="st">&#39;It</span><span class="ch">\&#39;</span><span class="st">s a beautiful day!&#39;</span>
<span class="bu">print</span>(my_string)</code></pre></div>
<pre><code>It&#39;s a beautiful day!</code></pre>
<p>Alternatively, you can also use double-quotes if your string contains a single-quote.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">my_string <span class="op">=</span> <span class="st">&quot;It&#39;s a beautiful day!&quot;</span></code></pre></div>
<p>What if our string contains both single and double quotes?</p>
<p>We can use triple-quotes! Enclosing the string in triple quotes ensures both single and double quotes are treated correctly.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">latitude <span class="op">=</span> <span class="st">&#39;&#39;&#39;37° 46&#39; 26.2992 N&#39;&#39;&#39;</span>
longitude <span class="op">=</span> <span class="st">&#39;&#39;&#39;122° 25&#39; 52.6692&quot; W&#39;&#39;&#39;</span>
<span class="bu">print</span>(latitude, longitude)</code></pre></div>
<pre><code>37° 46&#39; 26.2992 N 122° 25&#39; 52.6692&quot; W</code></pre>
<p>Backslashes pose another problem when dealing with Windows paths</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">#path = &#39;C:\Users\ujaval&#39;</span>
<span class="co">#print(path)</span></code></pre></div>
<p>Prefixing a string with <strong>r</strong> makes is a <em>Raw string</em>. Which doesn’t interpret backslash as a special character</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">path <span class="op">=</span> <span class="vs">r&#39;C:\Users\ujaval&#39;</span>
<span class="bu">print</span>(path)</code></pre></div>
<pre><code>C:\Users\ujaval</code></pre>
</div>
<div id="printing-strings" class="section level2">
<h2>Printing Strings</h2>
<p>Modern way of creating strings from variables is using the <code>format()</code> method</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">city <span class="op">=</span> <span class="st">&#39;San Fransico&#39;</span>
population <span class="op">=</span> <span class="dv">881549</span>
output <span class="op">=</span> <span class="st">&#39;Population of </span><span class="sc">{}</span><span class="st"> is </span><span class="sc">{}</span><span class="st">.&#39;</span>.<span class="bu">format</span>(city, population)
<span class="bu">print</span>(output)</code></pre></div>
<pre><code>Population of San Fransico is 881549.</code></pre>
<p>You can also use the format method to control the precision of the numbers</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">latitude <span class="op">=</span> <span class="fl">37.7749</span>
longitude <span class="op">=</span> <span class="op">-</span><span class="fl">122.4194</span>

coordinates <span class="op">=</span> <span class="st">&#39;</span><span class="sc">{:.2f}</span><span class="st">,</span><span class="sc">{:.2f}</span><span class="st">&#39;</span>.<span class="bu">format</span>(latitude, longitude)
<span class="bu">print</span>(coordinates)</code></pre></div>
<pre><code>37.77,-122.42</code></pre>
<hr />
</div>
<div id="exercise-2" class="section level2">
<h2>Exercise</h2>
<p>Use the string slicing to extract and print the degrees, minutes and second parts of the string below.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">latitude <span class="op">=</span> <span class="st">&#39;&#39;&#39;37° 46&#39; 26.2992 N&#39;&#39;&#39;</span></code></pre></div>

<p>Open the notebook named <code>04_loops_and_conditionals.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="loops-and-conditionals" class="section level1">
<h1>Loops and Conditionals</h1>
<div id="for-loops" class="section level2">
<h2>For Loops</h2>
<p>A for loop is used for iterating over a sequence. The sequence can be a list, a tuple, a dictionary, a set, or a string.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">cities <span class="op">=</span> [<span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;Los Angeles&#39;</span>, <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]

<span class="cf">for</span> city <span class="kw">in</span> cities:
    <span class="bu">print</span>(city)</code></pre></div>
<p>To iterate over a dictionary, you can call the <code>items()</code> method on it which returns a tuple of key and value for each item.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">data <span class="op">=</span> {<span class="st">&#39;city&#39;</span>: <span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;population&#39;</span>: <span class="dv">881549</span>, <span class="st">&#39;coordinates&#39;</span>: (<span class="op">-</span><span class="fl">122.4194</span>, <span class="fl">37.7749</span>) }

<span class="cf">for</span> x, y <span class="kw">in</span> data.items():
    <span class="bu">print</span>(x, y)</code></pre></div>
<pre><code>city San Francisco
population 881549
coordinates (-122.4194, 37.7749)</code></pre>
<p>The built-in <code>range()</code> function allows you to create sequence of numbers that you can iterate over</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):
    <span class="bu">print</span>(x)</code></pre></div>
<pre><code>0
1
2
3
4</code></pre>
<p>The range function can also take a start and an end number</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">2</span>):
    <span class="bu">print</span>(x)</code></pre></div>
<pre><code>1
3
5
7
9</code></pre>
</div>
</div>
<div id="conditionals" class="section level1">
<h1>Conditionals</h1>
<p>Python supports logical conditions such as equals, not equals, greater than etc. These conditions can be used in several ways, most commonly in <em>if statements</em> and loops.</p>
<p>An <em>if statement</em> is written by using the <code>if</code> keyword.</p>
<p>Note: A very common error that programmers make is to use <em>=</em> to evaluate a <em>equals to</em> condition. The <em>=</em> in Python means assignment, not equals to. Always ensure that you use the <em>==</em> for an equals to condition.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">for</span> city <span class="kw">in</span> cities:
    <span class="cf">if</span> city <span class="op">==</span> <span class="st">&#39;Atlanta&#39;</span>:
        <span class="bu">print</span>(city)</code></pre></div>
<pre><code>Atlanta</code></pre>
<p>You can use <code>else</code> keywords along with <code>if</code> to match elements that do not meet the condition</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">for</span> city <span class="kw">in</span> cities:
    <span class="cf">if</span> city <span class="op">==</span> <span class="st">&#39;Atlanta&#39;</span>:
        <span class="bu">print</span>(city)
    <span class="cf">else</span>:
        <span class="bu">print</span>(<span class="st">&#39;This is not Atlanta&#39;</span>)</code></pre></div>
<pre><code>This is not Atlanta
This is not Atlanta
This is not Atlanta
Atlanta</code></pre>
<p>Python relies on indentation (whitespace at the beginning of a line) to define scope in the for loop and if statements. So make sure your code is properly indented.</p>
<p>You can evaluate a series of conditions using the <code>elif</code> keyword.</p>
<p>Multiple criteria can be combined using the <code>and</code> and <code>or</code> keywords.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">cities_population <span class="op">=</span> {
    <span class="st">&#39;San Francisco&#39;</span>: <span class="dv">881549</span>,
    <span class="st">&#39;Los Angeles&#39;</span>: <span class="dv">3792621</span>,
    <span class="st">&#39;New York&#39;</span>: <span class="dv">8175133</span>,
    <span class="st">&#39;Atlanta&#39;</span>:<span class="dv">498044</span>
}

<span class="cf">for</span> city, population <span class="kw">in</span> cities_population.items():
    <span class="cf">if</span> population <span class="op">&lt;</span> <span class="dv">1000000</span>:
        <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">{}</span><span class="st"> is a small city&#39;</span>.<span class="bu">format</span>(city))
    <span class="cf">elif</span> population <span class="op">&gt;</span> <span class="dv">1000000</span> <span class="kw">and</span> population <span class="op">&lt;</span> <span class="dv">5000000</span>:
        <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">{}</span><span class="st"> is a big city&#39;</span>.<span class="bu">format</span>(city))
    <span class="cf">else</span>:
        <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">{}</span><span class="st"> is a mega city&#39;</span>.<span class="bu">format</span>(city))</code></pre></div>
<pre><code>San Francisco is a small city
Los Angeles is a big city
New York is a mega city
Atlanta is a small city</code></pre>
<div id="control-statements" class="section level2">
<h2>Control Statements</h2>
<p>A for-loop iterates over each item in the sequence. Sometimes is desirable to stop the execution, or skip certain parts of the for-loops. Python has special statements, <code>break</code>, <code>continue</code> and <code>pass</code>.</p>
<p>A <code>break</code> statement will stop the loop and exit out of it</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">for</span> city <span class="kw">in</span> cities:
    <span class="bu">print</span>(city)
    <span class="cf">if</span> city <span class="op">==</span> <span class="st">&#39;Los Angeles&#39;</span>:
        <span class="bu">print</span>(<span class="st">&#39;I found Los Angeles&#39;</span>)
        <span class="cf">break</span></code></pre></div>
<pre><code>San Francisco
Los Angeles
I found Los Angeles</code></pre>
<p>A <code>continue</code> statement will skip the remaining part of the loop and go to the next iteration</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">for</span> city <span class="kw">in</span> cities:
    <span class="cf">if</span> city <span class="op">==</span> <span class="st">&#39;Los Angeles&#39;</span>:
        <span class="cf">continue</span>
    <span class="bu">print</span>(city)</code></pre></div>
<pre><code>San Francisco
New York
Atlanta</code></pre>
<p>A <code>pass</code> statement doesn’t do anything. It is useful when some code is required to complete the syntax, but you do not want any code to execute. It is typically used as a placeholder when a function is not complete.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">for</span> city <span class="kw">in</span> cities:
    <span class="cf">if</span> city <span class="op">==</span> <span class="st">&#39;Los Angeles&#39;</span>:
        <span class="cf">pass</span>
    <span class="cf">else</span>:
        <span class="bu">print</span>(city)</code></pre></div>
<pre><code>San Francisco
New York
Atlanta</code></pre>
</div>
<div id="exercise-3" class="section level2">
<h2>Exercise</h2>
<p>The Fizz Buzz challenge.</p>
<p>Write a program that prints the numbers from 1 to 100 and for multiples of 3 print <strong>Fizz</strong> instead of the number and for the multiples of 5 print <strong>Buzz</strong>. If it is divisible by both, print <strong>FizzBuzz</strong>.</p>
<p>So the output should be something like below</p>
<p><code>1, 2, Fizz, 4, Buzz, Fizz, 7, 8, Fizz, Buzz, 11, Fizz, 13, 14, FizzBuzz, ...</code></p>
<p>Breaking down the problem further, we need to create for-loop with following conditions</p>
<ul>
<li>If the number is a multiple of both 3 and 5 (i.e. 15), print FizzBuzz</li>
<li>If the number is multiple of 3, print Fizz</li>
<li>If the number is multiple of 5, print Buzz</li>
<li>Otherwise print the number</li>
</ul>
<p>Hint: See the code cell below. Use the modulus operator <strong>%</strong> to check if a number is divisible by another. <code>10 % 5</code> equals 0, meaning it is divisible by 5.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">10</span>):
    <span class="cf">if</span> x<span class="op">%</span><span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:
        <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">{}</span><span class="st"> is divisible by 2&#39;</span>.<span class="bu">format</span>(x))
    <span class="cf">else</span>:
        <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">{}</span><span class="st"> is not divisible by 2&#39;</span>.<span class="bu">format</span>(x))</code></pre></div>
<pre><code>1 is not divisible by 2
2 is divisible by 2
3 is not divisible by 2
4 is divisible by 2
5 is not divisible by 2
6 is divisible by 2
7 is not divisible by 2
8 is divisible by 2
9 is not divisible by 2</code></pre>
<hr />

<p>Open the notebook named <code>05_functions.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="functions" class="section level1">
<h1>Functions</h1>
<p>A function is a block of code that takes one or more <em>inputs</em>, does some processing on them and returns one or more <em>outputs</em>. The code within the function runs only when it is called.</p>
<p>A funtion is defined using the <code>def</code> keyword</p>
<pre><code>def my_function():
    ....
    ....
    return something</code></pre>
<p>Functions are useful because they allow us to capture the logic of our code and we can run it with differnt inputs without having to write the same code again and again.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> greet(name):
    <span class="cf">return</span> <span class="st">&#39;Hello &#39;</span> <span class="op">+</span> name

<span class="bu">print</span>(greet(<span class="st">&#39;World&#39;</span>))</code></pre></div>
<pre><code>Hello World</code></pre>
<p>Functions can also take arguments with a default value. This helps make calling the functions simpler for the default behavior while giving an option to pass on extra arguments.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">lat <span class="op">=</span> <span class="fl">37.7739</span>
lng <span class="op">=</span> <span class="op">-</span><span class="fl">121.5687</span>

<span class="kw">def</span> format_coordinates(latitude, longitude, separator<span class="op">=</span><span class="st">&#39;,&#39;</span>):
        <span class="cf">return</span> <span class="st">&#39;</span><span class="sc">{}{}{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(latitude, separator, longitude)

<span class="bu">print</span>(format_coordinates(lat, lng))
<span class="bu">print</span>(format_coordinates(lat, lng, <span class="st">&#39;|&#39;</span>))</code></pre></div>
<pre><code>37.7739,-121.5687
37.7739|-121.5687</code></pre>
<p>The default behavior of Python functions is to take <em>positional arguments</em>. You pass the arguments in the <em>order</em> that is defined by the function. Python allows functions to be called using <em>keyword arguments</em>. When we call functions in this way, the order (position) of the arguments can be changed. The main advantage of using keyword arguments is to make the code more readable and explicit.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(format_coordinates(latitude<span class="op">=</span>lat, longitude<span class="op">=</span>lng, separator<span class="op">=</span><span class="st">&#39;;&#39;</span>))</code></pre></div>
<pre><code>37.7739;-121.5687</code></pre>
<div id="exercise-4" class="section level2">
<h2>Exercise</h2>
<p>Functions can take multiple arguments. Let’s write a function to convert coordinates from degrees, minutes, seconds to decimal degrees. This conversion is needed quite often when working with data collected from GPS devices.</p>
<ul>
<li>1 degree is equal to 60 minutes</li>
<li>1 minute is equal to 60 seconds (3600 seconds)</li>
</ul>
<p>To calculate decimal degrees, we can use the formula below:</p>
<p>If degrees are positive:</p>
<p><code>Decimal Degrees = degrees + (minutes/60) + (seconds/3600)</code></p>
<p>If degrees are negative</p>
<p><code>Decimal Degrees = degrees - (minutes/60) - (seconds/3600)</code></p>
<p>Delete the <code>pass</code> statement and replace it with the code for the formula. If the code is correct, you should see the result 37.773972 -121.56869</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">latitude <span class="op">=</span> (<span class="dv">37</span>, <span class="dv">46</span>, <span class="fl">26.2992</span>)
longitude <span class="op">=</span> (<span class="op">-</span><span class="dv">121</span>, <span class="dv">34</span>, <span class="fl">7.32</span>)

<span class="kw">def</span> dms_to_decimal(degrees, minutes, seconds):
    <span class="cf">pass</span>

<span class="co"># Extract the degree, minute and seconds values from the tuple</span>
lat_deg, lat_min, lat_sec <span class="op">=</span> latitude
lon_deg, lon_min, lon_sec <span class="op">=</span> longitude

lat_decimal <span class="op">=</span> dms_to_decimal(lat_deg, lat_min, lat_sec)
lon_decimal <span class="op">=</span> dms_to_decimal(lon_deg, lon_min, lon_sec)
<span class="bu">print</span>(lat_decimal, lon_decimal)</code></pre></div>
<pre><code>None None</code></pre>
<hr />

<p>Open the notebook named <code>06_standard_library.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="the-python-standard-library" class="section level1">
<h1>The Python Standard Library</h1>
<p>Python comes with many built-in modules that offer ready-to-use solutions to common programming problems. To use these modules, you must use the <code>import</code> keyword. Once imported in your Python script, you can use the functions provided by the module in your script.</p>
<p>We will use the built-in <code>math</code> module that allows us to use advanced mathematical functions.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> math</code></pre></div>
<p>You can also import specific functions or constants from the module like below</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> math <span class="im">import</span> pi
<span class="bu">print</span>(pi)</code></pre></div>
<pre><code>3.141592653589793</code></pre>
<div id="calculating-distance" class="section level2">
<h2>Calculating Distance</h2>
<p>Given 2 points with their Latitude and Longitude coordinates, the Haversine Formula calculates the straight-line distance in meters, assuming that Earth is a sphere.</p>
<p>The formula is simple enough to be implemented in a spreadsheet too. If you are curious, see <a href="https://spatialthoughts.com/2013/07/06/calculate-distance-spreadsheet/">my post</a> about using this formula for calculating distances in a spreadsheet.</p>
<p>We can write a function that accepts a pair of origin and destination coordinates and computes the distance.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">san_francisco <span class="op">=</span> (<span class="fl">37.7749</span>, <span class="op">-</span><span class="fl">122.4194</span>)
new_york <span class="op">=</span> (<span class="fl">40.661</span>, <span class="op">-</span><span class="fl">73.944</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> haversine_distance(origin, destination):
  lat1, lon1 <span class="op">=</span> origin
  lat2, lon2 <span class="op">=</span> destination
  radius <span class="op">=</span> <span class="dv">6371000</span>
  dlat <span class="op">=</span> math.radians(lat2<span class="op">-</span>lat1)
  dlon <span class="op">=</span> math.radians(lon2<span class="op">-</span>lon1)
  a <span class="op">=</span> math.sin(dlat<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span> math.sin(dlat<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> math.cos(math.radians(lat1)) <span class="op">\</span>
    <span class="op">*</span> math.cos(math.radians(lat2)) <span class="op">*</span> math.sin(dlon<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span> math.sin(dlon<span class="op">/</span><span class="dv">2</span>)
  c <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> math.atan2(math.sqrt(a), math.sqrt(<span class="dv">1</span><span class="op">-</span>a))
  distance <span class="op">=</span> radius <span class="op">*</span> c
  <span class="cf">return</span> distance</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">distance <span class="op">=</span> haversine_distance(san_francisco, new_york)
<span class="bu">print</span>(distance<span class="op">/</span><span class="dv">1000</span>, <span class="st">&#39;km&#39;</span>)</code></pre></div>
<pre><code>4135.374617164737 km</code></pre>
</div>
<div id="discover-python-easter-eggs" class="section level2">
<h2>Discover Python Easter Eggs</h2>
<p>Programmers love to hide secret jokes in their programs for gun. These are known as <em>Easter Eggs</em>. Python has an easter egg that you can see when you try to import the module named <code>this</code>. Try writing the command <code>import this</code> below.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> this</code></pre></div>
<pre><code>The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren&#39;t special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you&#39;re Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it&#39;s a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let&#39;s do more of those!</code></pre>
<p>Let’s try one more. Try importing the <code>antigravity</code> module.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> antigravity</code></pre></div>
<p>Here’s a complete list of <a href="https://towardsdatascience.com/7-easter-eggs-in-python-7765dc15a203">easter eggs in Python</a>.</p>
</div>
<div id="exercise-5" class="section level2">
<h2>Exercise</h2>
<p>Find the coordinates of 2 cities near you and calculate the distance between them by calling the <code>haversine_distance</code> function below.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="kw">def</span> haversine_distance(origin, destination):
  lat1, lon1 <span class="op">=</span> origin
  lat2, lon2 <span class="op">=</span> destination
  radius <span class="op">=</span> <span class="dv">6371000</span>
  dlat <span class="op">=</span> math.radians(lat2<span class="op">-</span>lat1)
  dlon <span class="op">=</span> math.radians(lon2<span class="op">-</span>lon1)
  a <span class="op">=</span> math.sin(dlat<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span> math.sin(dlat<span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> math.cos(math.radians(lat1)) <span class="op">\</span>
    <span class="op">*</span> math.cos(math.radians(lat2)) <span class="op">*</span> math.sin(dlon<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span> math.sin(dlon<span class="op">/</span><span class="dv">2</span>)
  c <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> math.atan2(math.sqrt(a), math.sqrt(<span class="dv">1</span><span class="op">-</span>a))
  distance <span class="op">=</span> radius <span class="op">*</span> c
  <span class="cf">return</span> distance

<span class="co"># city1 = (lat1, lng1)</span>
<span class="co"># city2 = (lat2, lng2)</span>
<span class="co"># call the function and print the result</span></code></pre></div>
<hr />

<p>Open the notebook named <code>07_third_party_modules.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="third-party-modules" class="section level1">
<h1>Third-party Modules</h1>
<p>Python has a thriving ecosystem of third-party modules (i.e. libraries or packages) available for you to install. There are hundreds of thousands of such modules available for you to install and use.</p>
<div id="installing-third-party-libraries" class="section level2">
<h2>Installing third-party libraries</h2>
<p>Python comes with a package manager called <code>pip</code>. It can install all the packages listed at <a href="https://pypi.org/">PyPI (Python Package Index)</a>. To install a package using pip, you need to run a command like following in a Terminal or CMD prompt.</p>
<p><code>pip install &lt;package name&gt;</code></p>
<p>For this course, we are using Anancoda platform - which comes with its own package manager called <code>conda</code>. You can use Anaconda Navigator to search and install packages. Or run the command like following in a Terminal or CMD Prompt.</p>
<p><code>conda install &lt;package name&gt;</code></p>
<p>See this <a href="https://www.anaconda.com/blog/understanding-conda-and-pip">comparison of pip and conda</a> to understand the differences.</p>
</div>
<div id="calculating-distance-1" class="section level2">
<h2>Calculating Distance</h2>
<p>We have already installed the <code>geopy</code> package in our environment. <code>geopy</code> comes with functions that have already implemented many distance calculation formulae.</p>
<ul>
<li><code>distance.great_circle()</code>: Calculates the distance on a great circle using haversine formula</li>
<li><code>distance.geodesic()</code>: Calculates the distance using a chosen ellipsoid using vincenty’s formula</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> geopy <span class="im">import</span> distance

san_francisco <span class="op">=</span> (<span class="fl">37.7749</span>, <span class="op">-</span><span class="fl">122.4194</span>)
new_york <span class="op">=</span> (<span class="fl">40.661</span>, <span class="op">-</span><span class="fl">73.944</span>)

straight_line_distance <span class="op">=</span> distance.great_circle(san_francisco, new_york)
ellipsoid_distance <span class="op">=</span> distance.geodesic(san_francisco, new_york, ellipsoid<span class="op">=</span><span class="st">&#39;WGS-84&#39;</span>)

<span class="bu">print</span>(straight_line_distance, ellipsoid_distance)</code></pre></div>
<pre><code>4135.3804590061345 km 4145.446977549562 km</code></pre>
</div>
<div id="exercise-6" class="section level2">
<h2>Exercise</h2>
<p>Repeat the distance calculation exercise from the previous module but perform the calculation using the geopy library.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> geopy <span class="im">import</span> distance

<span class="co"># city1 = (lat1, lng1)</span>
<span class="co"># city2 = (lat2, lng2)</span>
<span class="co"># call the geopy distance function and print the great circle and ellipsoid distance</span></code></pre></div>
<hr />

<p>Open the notebook named <code>08_reading_files.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="reading-files" class="section level1">
<h1>Reading Files</h1>
<p>Python provides built-in functions for reading and writing files.</p>
<p>To read a file, we must know the path of the file on the disk. Python has a module called <code>os</code> that has helper functions that helps dealing with the the operating system. Advantage of using the <code>os</code> module is that the code you write will work without change on any suppored operating systems.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> os</code></pre></div>
<p>To open a file, we need to know the path to the file. We will now open and read the file <code>worldcitites.csv</code> located in your data package. In your data package the data folder is in the <code>data/</code> directory. We can construct the relative path to the file using the <code>os.path.join()</code> method.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span>
filename <span class="op">=</span> <span class="st">&#39;worldcities.csv&#39;</span>
path <span class="op">=</span> os.path.join(data_pkg_path, filename)
<span class="bu">print</span>(path)</code></pre></div>
<pre><code>data/worldcities.csv</code></pre>
<p>To open the file, use the built-in <code>open()</code> function. We specify the <em>mode</em> as <code>r</code> which means read-only. If we wanted to change the file contents or write a new file, we would open it with <code>w</code> mode.</p>
<p>Our input file also contains Unicode characters, so we specify <code>UTF-8</code> as the encoding.</p>
<p>The open() function returns a file object. We can call the <code>readline()</code> method for reading the content of the file, one line at a time.</p>
<p>It is a good practice to always close the file when you are done with it. To close the file, we must call the <code>close()</code> method on the file object.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">f <span class="op">=</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>)
<span class="bu">print</span>(f.readline())
<span class="bu">print</span>(f.readline())
f.close()</code></pre></div>
<pre><code>&quot;city&quot;,&quot;city_ascii&quot;,&quot;lat&quot;,&quot;lng&quot;,&quot;country&quot;,&quot;iso2&quot;,&quot;iso3&quot;,&quot;admin_name&quot;,&quot;capital&quot;,&quot;population&quot;,&quot;id&quot;

&quot;Tokyo&quot;,&quot;Tokyo&quot;,&quot;35.6850&quot;,&quot;139.7514&quot;,&quot;Japan&quot;,&quot;JP&quot;,&quot;JPN&quot;,&quot;Tōkyō&quot;,&quot;primary&quot;,&quot;35676000&quot;,&quot;1392685764&quot;</code></pre>
<p>Calling <code>readline()</code> for each line of the file is tedious. Ideally, we want to loop through all the lines in file. You can iterate through the file object like below.</p>
<p>We can loop through each line of the file and increase the <code>count</code> variable by 1 for each iteration of the loop. At the end, the count variable’s value will be equal to the number of lines in the file.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">f <span class="op">=</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>)

count <span class="op">=</span> <span class="dv">0</span>
<span class="cf">for</span> line <span class="kw">in</span> f:
    count <span class="op">+=</span> <span class="dv">1</span>
f.close()
<span class="bu">print</span>(count)</code></pre></div>
<pre><code>15494</code></pre>
<div id="exercise-7" class="section level2">
<h2>Exercise</h2>
<p>Print first 5 lines of the file.</p>
<ul>
<li>Hint: Use break statement</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> os
data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span>
filename <span class="op">=</span> <span class="st">&#39;worldcities.csv&#39;</span>
path <span class="op">=</span> os.path.join(data_pkg_path, filename)

<span class="co"># Add code to open the file and read first 5 lines</span></code></pre></div>
<hr />

<p>Open the notebook named <code>09_reading_csv_file.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="reading-csv-files" class="section level1">
<h1>Reading CSV Files</h1>
<p>Comma-separated Values (CSV) are the most common text-based file format for sharing geospatial data. The structure of the file is 1 data record per line, with individual <em>columns</em> separated by a comma.</p>
<p>In general, the separator character is called a delimiter. Other popular delimiters include the tab (\t), colon (:) and semi-colon (;) characters.</p>
<p>Reading CSV file properly requires us to know which delimiter is being used, along with quote character to surround the field values that contain space of the delimiter character. Since reading delimited text file is a very common operation, and can be tricky to handle all the corner cases, Python comes with its own library called <code>csv</code> for easy reading and writing of CSV files. To use it, you just have to import it.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> csv</code></pre></div>
<p>The preferred way to read CSV files is using the <code>DictReader()</code> method. Which directly reads each row and creates a dictionary from it - with column names as <em>key</em> and column values as <em>value</em>. Let’s see how to read a file using the <code>csv.DictReader()</code> method.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> os
data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span>
filename <span class="op">=</span> <span class="st">&#39;worldcities.csv&#39;</span>
path <span class="op">=</span> os.path.join(data_pkg_path, filename)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">f <span class="op">=</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>)
csv_reader <span class="op">=</span> csv.DictReader(f, delimiter<span class="op">=</span><span class="st">&#39;,&#39;</span>, quotechar<span class="op">=</span><span class="st">&#39;&quot;&#39;</span>)
<span class="bu">print</span>(csv_reader)
f.close()</code></pre></div>
<pre><code>&lt;csv.DictReader object at 0x0000000005528548&gt;</code></pre>
<div id="using-enumerate-function" class="section level2">
<h2>Using <code>enumerate()</code> function</h2>
<p>When iterating over an object, many times we need a counter. We saw in the previous example, how to use a variable like <code>count</code> and increase it with every iteration. There is an easy way to do this using the built-in <code>enumerate()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">cities <span class="op">=</span> [<span class="st">&#39;San Francisco&#39;</span>, <span class="st">&#39;Los Angeles&#39;</span>, <span class="st">&#39;New York&#39;</span>, <span class="st">&#39;Atlanta&#39;</span>]
<span class="cf">for</span> x <span class="kw">in</span> <span class="bu">enumerate</span>(cities):
    <span class="bu">print</span>(x)</code></pre></div>
<pre><code>(0, &#39;San Francisco&#39;)
(1, &#39;Los Angeles&#39;)
(2, &#39;New York&#39;)
(3, &#39;Atlanta&#39;)</code></pre>
<p>We can use enumerate() on any iterable object and get a tuple with an index and the iterable value with each iteration. Let’s use it to print the first 5 lines from the DictReader object.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">f <span class="op">=</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>)
csv_reader <span class="op">=</span> csv.DictReader(f, delimiter<span class="op">=</span><span class="st">&#39;,&#39;</span>, quotechar<span class="op">=</span><span class="st">&#39;&quot;&#39;</span>)
<span class="cf">for</span> index, row <span class="kw">in</span> <span class="bu">enumerate</span>(csv_reader):
    <span class="bu">print</span>(row)
    <span class="cf">if</span> index <span class="op">==</span> <span class="dv">4</span>:
        <span class="cf">break</span>
f.close()</code></pre></div>
</div>
<div id="using-with-statement" class="section level2">
<h2>Using <code>with</code> statement</h2>
<p>The code for file handling requires we open a file, do something with the file object and then close the file. That is tedious and it is possible that you may forget to call <code>close()</code> on the file. If the code for processing encounters an error the file is not closed property, it may result in bugs - especially when writing files.</p>
<p>The preferred way to work with file objects is using the <code>with</code> statement. It results in simpler and cleaer code - which also ensures file objects are closed properly in case of errors.</p>
<p>As you see below, we open the file and use the file object <code>f</code> in a <code>with</code> statement. Python takes care of closing the file when the execution of code within the statement is complete.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:
    csv_reader <span class="op">=</span> csv.DictReader(f)</code></pre></div>
</div>
<div id="filtering-rows" class="section level2">
<h2>Filtering rows</h2>
<p>We can use conditional statement while iterating over the rows, to select and process rows that meet certain criterial. Let’s count how many cities from a particular country are present in the file.</p>
<p>Replace the <code>home_country</code> variable with your home country below.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">home_country <span class="op">=</span> <span class="st">&#39;India&#39;</span>
num_cities <span class="op">=</span> <span class="dv">0</span>

<span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:
    csv_reader <span class="op">=</span> csv.DictReader(f)

    <span class="cf">for</span> row <span class="kw">in</span> csv_reader:
        <span class="cf">if</span> row[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country:
            num_cities <span class="op">+=</span> <span class="dv">1</span>
            
<span class="bu">print</span>(num_cities)</code></pre></div>
<pre><code>212</code></pre>
</div>
<div id="calculating-distance-2" class="section level2">
<h2>Calculating distance</h2>
<p>Let’s apply the skills we have learnt so far to solve a complete problem. We want to read the <code>worldcities.csv</code> file, find all cities within a home country, calculate the distance to each cities from a home city and write the results to a new CSV file.</p>
<p>First we find the coordinates of the out selected <code>home_city</code> from the file. Replace the <code>home_city</code> below with your hometown or a large city within your country. Note that we are using the <code>city_ascii</code> field for city name comparison, so make sure the <code>home_city</code> variable contains the ASCII version of the city name.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">home_city <span class="op">=</span> <span class="st">&#39;Bengaluru&#39;</span>

home_city_coordinates <span class="op">=</span> ()

<span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:
    csv_reader <span class="op">=</span> csv.DictReader(f)
    <span class="cf">for</span> row <span class="kw">in</span> csv_reader:
        <span class="cf">if</span> row[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">==</span> home_city:
            lat <span class="op">=</span> row[<span class="st">&#39;lat&#39;</span>]
            lng <span class="op">=</span> row[<span class="st">&#39;lng&#39;</span>]
            home_city_coordinates <span class="op">=</span> (lat, lng)
            <span class="cf">break</span>
        
<span class="bu">print</span>(home_city_coordinates)</code></pre></div>
<pre><code>(&#39;12.9700&#39;, &#39;77.5600&#39;)</code></pre>
<p>Now we can loop through the file, find a city in the chosen home country and call the <code>geopy.distance.geodesic()</code> function to calculate the distance. In the code below, we are just computing first 5 matches.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> geopy <span class="im">import</span> distance

counter <span class="op">=</span> <span class="dv">0</span>
<span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:
    csv_reader <span class="op">=</span> csv.DictReader(f)
    <span class="cf">for</span> row <span class="kw">in</span> csv_reader:
        <span class="cf">if</span> (row[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country <span class="kw">and</span>
            row[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">!=</span> home_city):
            city_coordinates <span class="op">=</span> (row[<span class="st">&#39;lat&#39;</span>], row[<span class="st">&#39;lng&#39;</span>])
            city_distance <span class="op">=</span> distance.geodesic(
                city_coordinates, home_city_coordinates).km
            <span class="bu">print</span>(row[<span class="st">&#39;city_ascii&#39;</span>], city_distance)
            counter <span class="op">+=</span> <span class="dv">1</span>
            
        <span class="cf">if</span> counter <span class="op">==</span> <span class="dv">5</span>:
            <span class="cf">break</span>
            </code></pre></div>
<pre><code>Mumbai 837.1857087990928
Delhi 1738.638855782645
Kolkata 1552.6378233436674
Chennai 295.3401073046679
Hyderabad 500.0477286304823</code></pre>
</div>
<div id="writing-files" class="section level2">
<h2>Writing files</h2>
<p>Instead of printing the results, let’s write the results to a new file. Similar to csv.DictReader(), there is a companion <code>csv.DictWriter()</code> method to write files. We create a <code>csv_writer</code> object and then write rows to it using the <code>writerow()</code> method.</p>
<p>First we create an <code>output</code> folder to save the results. We can first check if the folder exists and if it doesn’t exist, we can create it.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span>
<span class="cf">if</span> <span class="kw">not</span> os.path.exists(output_dir):
    os.mkdir(output_dir)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">output_filename <span class="op">=</span> <span class="st">&#39;cities_distance.csv&#39;</span>
output_path <span class="op">=</span> os.path.join(output_dir, output_filename)

<span class="cf">with</span> <span class="bu">open</span>(output_path, mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> output_file:
    fieldnames <span class="op">=</span> [<span class="st">&#39;city&#39;</span>, <span class="st">&#39;distance_from_home&#39;</span>]
    csv_writer <span class="op">=</span> csv.DictWriter(output_file, fieldnames<span class="op">=</span>fieldnames)
    csv_writer.writeheader()
    
    <span class="co"># Now we read the input file, calculate distance and</span>
    <span class="co"># write a row to the output </span>
    <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:
        csv_reader <span class="op">=</span> csv.DictReader(f)
        <span class="cf">for</span> row <span class="kw">in</span> csv_reader:
            <span class="cf">if</span> (row[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country <span class="kw">and</span>
                row[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">!=</span> home_city):
                city_coordinates <span class="op">=</span> (row[<span class="st">&#39;lat&#39;</span>], row[<span class="st">&#39;lng&#39;</span>])
                city_distance <span class="op">=</span> distance.geodesic(
                    city_coordinates, home_city_coordinates).km
                csv_writer.writerow(
                    {<span class="st">&#39;city&#39;</span>: row[<span class="st">&#39;city_ascii&#39;</span>],
                     <span class="st">&#39;distance_from_home&#39;</span>: city_distance}
                )</code></pre></div>
<p>Below is the complete code for our task of reading a file, filtering it, calculating distance and writing the results to a file.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> csv
<span class="im">import</span> os
<span class="im">from</span> geopy <span class="im">import</span> distance

data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span>
input_filename <span class="op">=</span> <span class="st">&#39;worldcities.csv&#39;</span>
input_path <span class="op">=</span> os.path.join(data_pkg_path, input_filename)
output_filename <span class="op">=</span> <span class="st">&#39;cities_distance.csv&#39;</span>
output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span>
output_path <span class="op">=</span> os.path.join(output_dir, output_filename)

home_city <span class="op">=</span> <span class="st">&#39;Bengaluru&#39;</span>
home_country <span class="op">=</span> <span class="st">&#39;India&#39;</span>

<span class="cf">with</span> <span class="bu">open</span>(input_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> input_file:
    csv_reader <span class="op">=</span> csv.DictReader(input_file)
    <span class="cf">for</span> row <span class="kw">in</span> csv_reader:
        <span class="cf">if</span> row[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">==</span> home_city:
            home_city_coordinates <span class="op">=</span> (row[<span class="st">&#39;lat&#39;</span>], row[<span class="st">&#39;lng&#39;</span>])
            <span class="cf">break</span>

<span class="cf">with</span> <span class="bu">open</span>(output_path, mode<span class="op">=</span><span class="st">&#39;w&#39;</span>) <span class="im">as</span> output_file:
    fieldnames <span class="op">=</span> [<span class="st">&#39;city&#39;</span>, <span class="st">&#39;distance_from_home&#39;</span>]
    csv_writer <span class="op">=</span> csv.DictWriter(output_file, fieldnames<span class="op">=</span>fieldnames)
    csv_writer.writeheader()

    <span class="cf">with</span> <span class="bu">open</span>(input_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> input_file:
        csv_reader <span class="op">=</span> csv.DictReader(input_file)
        <span class="cf">for</span> row <span class="kw">in</span> csv_reader:
            <span class="cf">if</span> (row[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country <span class="kw">and</span>
                row[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">!=</span> home_city):
                city_coordinates <span class="op">=</span> (row[<span class="st">&#39;lat&#39;</span>], row[<span class="st">&#39;lng&#39;</span>])
                city_distance <span class="op">=</span> distance.geodesic(
                    city_coordinates, home_city_coordinates).km
                csv_writer.writerow(
                    {<span class="st">&#39;city&#39;</span>: row[<span class="st">&#39;city_ascii&#39;</span>],
                     <span class="st">&#39;distance_from_home&#39;</span>: city_distance}
                )

<span class="bu">print</span>(<span class="st">&#39;Successfully written output file at </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(output_path))</code></pre></div>
<pre><code>Successfully written output file at output/cities_distance.csv</code></pre>
</div>
<div id="exercise-8" class="section level2">
<h2>Exercise</h2>
<p>Let’s say we want to repeat the same process for another city. Or maybe all the cities in a country. The code above would require us to change the <code>home_city</code>, <code>home_country</code> and <code>output_filename</code> variables for the new city and run the code again manually.</p>
<p>Instead, we can create a <em>function</em> that does the operation based on given city name.</p>
<pre><code>def write_distance_file(home_city, home_country, output_filename):
    ....
    ....
    print(&#39;Successfully written output file at {}&#39;.format(output_path))</code></pre>
<p>Then we can call the function like below</p>
<pre><code>write_distance_file(&#39;Frankfurt&#39;, &#39;Germany&#39;, &#39;frankfurt_distance.csv&#39;)
write_distance_file(&#39;New York&#39;, &#39;United States&#39;, &#39;nyc_distance.csv&#39;)</code></pre>
<p>Insert a new code cell below and create the <code>write_distance_file</code> function below. Then call it to create the output file as show.</p>
<hr />

<p>Open the notebook named <code>10_using_web_apis.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="using-web-apis" class="section level1">
<h1>Using Web APIs</h1>
<p>An API, or Application Program Interface, allows one program to <em>talk</em> to another program. Many websites or services provide an API so you can query for information in an automated way.</p>
<p>For mapping and spatial analysis, being able to use APIs is critical. For the longest time, Google Maps API was the most popular API on the web. APIs allow you to query web servers and get results without downloading data or running computation on your machine.</p>
<p>Common use cases for using APIs for spatial analysis are</p>
<ul>
<li>Getting directions / routing</li>
<li>Route optimization</li>
<li>Geocoding</li>
<li>Downloading data</li>
<li>Getting real-time weather data</li>
<li>…</li>
</ul>
<p>The provide of such APIs have many ways to implement an API. There are standards such as REST, SOAP, GraphQL etc. <em>REST</em> is the most populat standard for web APIs, and for geospatial APIs. REST APIs are used over HTTP and thus called web APIs.</p>
<div id="understanding-json-and-geojson" class="section level2">
<h2>Understanding JSON and GeoJSON</h2>
<p>JSON stands for <strong>J</strong>ava<strong>S</strong>cript <strong>O</strong>bject <strong>N</strong>otation. It is a format for storing and transporting data, and is the de-facto standard for data exchanged by APIs. GeoJSON is an extension of the JSON format that is commonly used to represent spatial data.</p>
<p>Python has a built-in <code>json</code> module that has methods for reading json data and converting it to Python objects, and vice-versa. In this example, we are using the <code>requests</code> module for querying the API which conveniently does the conversion for us. But it is useful to learn the basics of working with JSON in Python.</p>
<p>The GeoJSON data contains <em>features</em>, where each feature has some <em>properties</em> and a <em>geometry</em>.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">geojson_string <span class="op">=</span> <span class="st">&#39;&#39;&#39;</span>
<span class="st">{</span>
<span class="st">  &quot;type&quot;: &quot;FeatureCollection&quot;,</span>
<span class="st">  &quot;features&quot;: [</span>
<span class="st">    {&quot;type&quot;: &quot;Feature&quot;,</span>
<span class="st">      &quot;properties&quot;: {&quot;name&quot;: &quot;San Francisco&quot;},</span>
<span class="st">      &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [-121.5687, 37.7739]}</span>
<span class="st">    }</span>
<span class="st">  ]</span>
<span class="st">}</span>
<span class="st">&#39;&#39;&#39;</span>
<span class="bu">print</span>(geojson_string)</code></pre></div>
<pre><code>{
  &quot;type&quot;: &quot;FeatureCollection&quot;,
  &quot;features&quot;: [
    {&quot;type&quot;: &quot;Feature&quot;,
      &quot;properties&quot;: {&quot;name&quot;: &quot;San Francisco&quot;},
      &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [-121.5687, 37.7739]}
    }
  ]
}</code></pre>
<p>To convert a JSON string to a Python object (i.e. parsing JSON), we can use the <code>json.loads()</code> method.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> json

data <span class="op">=</span> json.loads(geojson_string)
<span class="bu">print</span>(<span class="bu">type</span>(data))
<span class="bu">print</span>(data)</code></pre></div>
<p>Now that we have <em>parsed</em> the GeoJSON string and have a Python object, we can extract infromation from it. The data is stored in a <em>FeatureCollection</em> - which is a list of <em>features</em>. In our example, we have just 1 feature inside the feature collection, so we can access it by using index <strong>0</strong>.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">city_data <span class="op">=</span> data[<span class="st">&#39;features&#39;</span>][<span class="dv">0</span>]
<span class="bu">print</span>(city_data)</code></pre></div>
<p>The feature representation is a dictionary, and individual items can be accesses using the <em>keys</em></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">city_name <span class="op">=</span> city_data[<span class="st">&#39;properties&#39;</span>][<span class="st">&#39;name&#39;</span>]
city_coordinates <span class="op">=</span> city_data[<span class="st">&#39;geometry&#39;</span>][<span class="st">&#39;coordinates&#39;</span>]
<span class="bu">print</span>(city_name, city_coordinates)</code></pre></div>
<pre><code>San Francisco [-121.5687, 37.7739]</code></pre>
</div>
<div id="the-requests-module" class="section level2">
<h2>The <code>requests</code> module</h2>
<p>To query a server, we send a <strong>GET</strong> request with some parameters and the server sends a response back. The <code>requests</code> module allows you to send HTTP requests and parse the responses using Python.</p>
<p>The response contains the data received from the server. It contains the HTTP <em>status_code</em> which tells us if the request was successful. HTTP code 200 stands for <em>Sucess OK</em>.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> requests

response <span class="op">=</span> requests.get(<span class="st">&#39;https://www.spatialthoughts.com&#39;</span>)

<span class="bu">print</span>(response.status_code)</code></pre></div>
<pre><code>200</code></pre>
</div>
<div id="calculating-distance-using-openrouteservice-api" class="section level2">
<h2>Calculating Distance using OpenRouteService API</h2>
<p><a href="https://openrouteservice.org/">OpenRouteService (ORS)</a> provides a free API for routing, distance matrix, geocoding, route optimization etc. using OpenStreetMap data. We will learn how to use this API through Python and get real-world distance between cities.</p>
<p>Almost all APIs require you to sign-up and obtain a <em>key</em>. The <em>key</em> is used to identify you and enforce usage limits so that you do not overwhelm the servers. We will obtain a key from OpenRouteServie so we can use their API</p>
<p>Visit <a href="https://openrouteservice.org/dev/#/signup">OpenRouteService Sign-up page</a> and create an account. Once your account is activated, visit your Dashboard and request a token. Select <em>Free</em> as the Token type and enter <code>python_foundation</code> as the Token name. Click <em>CREATE TOKEN</em>. Once created, copy the long string displayed under Key and enter below.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">ORS_API_KEY <span class="op">=</span> <span class="st">&#39;&lt;replace this with your key&gt;&#39;</span></code></pre></div>
<p>We will use the OpenRouteServices’s <a href="https://openrouteservice.org/dev/#/api-docs/v2/directions/%7Bprofile%7D/get">Directions Service</a>. This service returns the driving, biking or walking directions between the given origin and destination points.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">san_francisco <span class="op">=</span> (<span class="fl">37.7749</span>, <span class="op">-</span><span class="fl">122.4194</span>)
new_york <span class="op">=</span> (<span class="fl">40.661</span>, <span class="op">-</span><span class="fl">73.944</span>)

parameters <span class="op">=</span> {
    <span class="st">&#39;api_key&#39;</span>: ORS_API_KEY,
    <span class="st">&#39;start&#39;</span> : <span class="st">&#39;</span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(san_francisco[<span class="dv">1</span>], san_francisco[<span class="dv">0</span>]),
    <span class="st">&#39;end&#39;</span> : <span class="st">&#39;</span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(new_york[<span class="dv">1</span>], new_york[<span class="dv">0</span>])
}

response <span class="op">=</span> requests.get(
    <span class="st">&#39;https://api.openrouteservice.org/v2/directions/driving-car&#39;</span>, params<span class="op">=</span>parameters)

<span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:
    <span class="bu">print</span>(<span class="st">&#39;Request successful.&#39;</span>)
    data <span class="op">=</span> response.json()
<span class="cf">else</span>:
    <span class="bu">print</span>(<span class="st">&#39;Request failed.&#39;</span>)</code></pre></div>
<pre><code>Request successful.</code></pre>
<p>We can read the <code>response</code> in JSON format by calling <code>json()</code> method on it.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">data <span class="op">=</span> response.json()</code></pre></div>
<p>The response is a GeoJSON object representing the driving direction between the 2 points. The object is a feature collection with just 1 feature. We can access it using the index <strong>0</strong>. The feature’s property contains <code>summary</code> information which has the data we need.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">summary <span class="op">=</span> data[<span class="st">&#39;features&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;properties&#39;</span>][<span class="st">&#39;summary&#39;</span>]
<span class="bu">print</span>(summary)</code></pre></div>
<pre><code>{&#39;distance&#39;: 4691607.4, &#39;duration&#39;: 166280.6}</code></pre>
<p>We can extract the <code>distance</code> and convert it to kilometers.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">distance <span class="op">=</span> summary[<span class="st">&#39;distance&#39;</span>]
<span class="bu">print</span>(distance<span class="op">/</span><span class="dv">1000</span>)</code></pre></div>
<pre><code>4691.6080999999995</code></pre>
<p>You can compare this distance to the straight-line distance and see the difference.</p>
<div class="figure">
<img src="images/python_foundation/ors_direction.png" />

</div>
</div>
<div id="api-rate-limiting" class="section level2">
<h2>API Rate Limiting</h2>
<p>Many web APIs enforce <em>rate limiting</em> - allowing a limited number of requests over time. With computers it is easy to write a for loop, or have multiple programs send hundrends or thousands of queries per second. The server may not be configured to handle such volume. So the providers specify the limits on how many and how fast the queries can be sent.</p>
<p>OpenRouteService lists several <a href="https://openrouteservice.org/plans/">API Restrictions</a>. The free plan allows for upto 40 direction requests/minute.</p>
<p>There are many libraries available to implement various strategies for rate limiting. But we can use the built-in <code>time</code> module to implement a very simple rate limiting method.</p>
<div id="the-time-module" class="section level3">
<h3>The <code>time</code> module</h3>
<p>Python Standard Library has a <code>time</code> module that allows for time related operation. It contains a method <code>time.sleep()</code> which delays the execution of the program for the specified number of seconds.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> time
<span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):
    <span class="bu">print</span>(x)
    time.sleep(<span class="dv">1</span>)</code></pre></div>
<pre><code>0
1
2
3
4
5
6
7
8
9</code></pre>
</div>
</div>
<div id="exercise-9" class="section level2">
<h2>Exercise</h2>
<p>Below cell contains a dictionary with 3 destination cities and their coordinates. Write a <code>for</code> loop to iterate over the <code>destination_cities</code> disctionary and call <code>get_driving_distance()</code> function to print real driving distance between San Fransico and each city. Rate limit your queries by adding <code>time.sleep(2)</code> between successive function calls.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> csv
<span class="im">import</span> os
<span class="im">import</span> requests
<span class="im">import</span> time
ORS_API_KEY <span class="op">=</span> <span class="st">&#39;&lt;replace this with your key&gt;&#39;</span>

<span class="kw">def</span> get_driving_distance(source_coordinates, dest_coordinates):
    parameters <span class="op">=</span> {
    <span class="st">&#39;api_key&#39;</span>: ORS_API_KEY,
    <span class="st">&#39;start&#39;</span> : <span class="st">&#39;</span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(source_coordinates[<span class="dv">1</span>], source_coordinates[<span class="dv">0</span>]),
    <span class="st">&#39;end&#39;</span> : <span class="st">&#39;</span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(dest_coordinates[<span class="dv">1</span>], dest_coordinates[<span class="dv">0</span>])
    }

    response <span class="op">=</span> requests.get(
        <span class="st">&#39;https://api.openrouteservice.org/v2/directions/driving-car&#39;</span>, params<span class="op">=</span>parameters)

    <span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:
        data <span class="op">=</span> response.json()
        summary <span class="op">=</span> data[<span class="st">&#39;features&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;properties&#39;</span>][<span class="st">&#39;summary&#39;</span>]
        distance <span class="op">=</span> summary[<span class="st">&#39;distance&#39;</span>]
        <span class="cf">return</span> distance<span class="op">/</span><span class="dv">1000</span>
    <span class="cf">else</span>:
        <span class="bu">print</span>(<span class="st">&#39;Request failed.&#39;</span>)
        <span class="cf">return</span> <span class="op">-</span><span class="dv">9999</span>

san_francisco <span class="op">=</span> (<span class="fl">37.7749</span>, <span class="op">-</span><span class="fl">122.4194</span>)

destination_cities <span class="op">=</span> {
    <span class="st">&#39;Los Angeles&#39;</span>: (<span class="fl">34.0522</span>, <span class="op">-</span><span class="fl">118.2437</span>),
    <span class="st">&#39;Boston&#39;</span>: (<span class="fl">42.3601</span>, <span class="op">-</span><span class="fl">71.0589</span>),
    <span class="st">&#39;Atlanta&#39;</span>: (<span class="fl">33.7490</span>, <span class="op">-</span><span class="fl">84.3880</span>)
}</code></pre></div>
<hr />

<p>Open the notebook named <code>11_working_with_pandas.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="working-with-pandas" class="section level1">
<h1>Working with Pandas</h1>
<div class="figure">
<img src="images/python_foundation/pandas-logo.png" />

</div>
<p>Pandas is a powerful library for working with data. Pandas provides fast and easy functions for reading data from files, and analyzing it.</p>
<p>Pandas is based on another library called <code>numpy</code> - which is widely used in scientific computing. Pandas extends <code>numpy</code> and provides new data types such as <strong>Index</strong>, <strong>Series</strong> and <strong>DataFrames</strong>.</p>
<p>Pandas implementation is very fast and efficient - so compared to other methods of data processing - using <code>pandas</code> results is simpler code and quick processing. We will now re-implement our code for reading a file and computing distance using Pandas.</p>
<p>By convention, <code>pandas</code> is commonly imported as <code>pd</code></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> pandas <span class="im">as</span> pd</code></pre></div>
<div id="reading-files-1" class="section level2">
<h2>Reading Files</h2>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> os
data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span>
filename <span class="op">=</span> <span class="st">&#39;worldcities.csv&#39;</span>
path <span class="op">=</span> os.path.join(data_pkg_path, filename)</code></pre></div>
<p>A <strong>DataFrame</strong> is the most used Pandas object. You can think of a DataFrame being equivalent to a Spreadsheet or an Attribute Table of a GIS layer.</p>
<p>Pandas provide easy methods to directly read files into a DataFrame. You can use methods such as <code>read_csv()</code>, <code>read_excel()</code>, <code>read_hdf()</code> and so forth to read a variety of formats. Here we will read the <code>worldcitites.csv</code> file using <code>read_csv()</code> method.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">df <span class="op">=</span> pd.read_csv(path)</code></pre></div>
<p>Once the file is read and a DataFrame object is created, we can inspect it using the <code>head()</code> method.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(df.head())</code></pre></div>
<pre><code>          city   city_ascii      lat       lng        country iso2 iso3  \
0        Tokyo        Tokyo  35.6850  139.7514          Japan   JP  JPN   
1     New York     New York  40.6943  -73.9249  United States   US  USA   
2  Mexico City  Mexico City  19.4424  -99.1310         Mexico   MX  MEX   
3       Mumbai       Mumbai  19.0170   72.8570          India   IN  IND   
4    São Paulo    Sao Paulo -23.5587  -46.6250         Brazil   BR  BRA   

         admin_name  capital  population          id  
0             Tōkyō  primary  35676000.0  1392685764  
1          New York      NaN  19354922.0  1840034016  
2  Ciudad de México  primary  19028000.0  1484247881  
3       Mahārāshtra    admin  18978000.0  1356226629  
4         São Paulo    admin  18845000.0  1076532519  </code></pre>
<p>There is also a <code>info()</code> method that shows basic information about the dataframe, such as number of rows/columns and data types of each column.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(df.info())</code></pre></div>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 15493 entries, 0 to 15492
Data columns (total 11 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   city        15493 non-null  object 
 1   city_ascii  15493 non-null  object 
 2   lat         15493 non-null  float64
 3   lng         15493 non-null  float64
 4   country     15493 non-null  object 
 5   iso2        15462 non-null  object 
 6   iso3        15493 non-null  object 
 7   admin_name  15302 non-null  object 
 8   capital     5246 non-null   object 
 9   population  13808 non-null  float64
 10  id          15493 non-null  int64  
dtypes: float64(3), int64(1), object(7)
memory usage: 1.3+ MB
None</code></pre>
</div>
<div id="filtering-data" class="section level2">
<h2>Filtering Data</h2>
<p>Pandas have many ways of selecting and filtered data from a dataframe. We will now see how to use the <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#boolean-indexing">Boolean Filtering</a> to filter the dataframe to rows that match a condition.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">home_country <span class="op">=</span> <span class="st">&#39;India&#39;</span>
filtered <span class="op">=</span> df[df[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country]
<span class="bu">print</span>(filtered)</code></pre></div>
<pre><code>           city city_ascii      lat      lng country iso2 iso3  \
3        Mumbai     Mumbai  19.0170  72.8570   India   IN  IND   
5         Delhi      Delhi  28.6700  77.2300   India   IN  IND   
7       Kolkata    Kolkata  22.4950  88.3247   India   IN  IND   
34      Chennai    Chennai  13.0900  80.2800   India   IN  IND   
36    Bengalūru  Bengaluru  12.9700  77.5600   India   IN  IND   
...         ...        ...      ...      ...     ...  ...  ...   
7305      Karūr      Karur  10.9504  78.0833   India   IN  IND   
7441     Jorhāt     Jorhat  26.7500  94.2167   India   IN  IND   
7583      Sopur      Sopur  34.3000  74.4667   India   IN  IND   
7681     Tezpur     Tezpur  26.6338  92.8000   India   IN  IND   
9384        Diu        Diu  20.7197  70.9904   India   IN  IND   

             admin_name capital  population          id  
3           Mahārāshtra   admin  18978000.0  1356226629  
5                 Delhi   admin  15926000.0  1356872604  
7           West Bengal   admin  14787000.0  1356060520  
34          Tamil Nādu    admin   7163000.0  1356374944  
36            Karnātaka   admin   6787000.0  1356410365  
...                 ...     ...         ...         ...  
7305        Tamil Nādu      NaN     76915.0  1356837900  
7441              Assam     NaN     69033.0  1356638741  
7583  Jammu and Kashmīr     NaN     63035.0  1356978065  
7681              Assam     NaN     58851.0  1356299437  
9384      Damān and Diu     NaN     23779.0  1356923516  

[212 rows x 11 columns]</code></pre>
<p>Filtered dataframe is a just view of the original data and we cannot make changes to it. We can save the filtered view to a new dataframe using the <code>copy()</code> method.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">country_df <span class="op">=</span> df[df[<span class="st">&#39;country&#39;</span>] <span class="op">==</span> home_country].copy()</code></pre></div>
<p>To locate a particular row or column from a dataframe, Pandas providea <code>loc[]</code> and <code>iloc[]</code> methods - that allows you to <em>locate</em> particular slices of data. Learn about <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#different-choices-for-indexing">different indexing methods</a> in Pandas. Here we can use <code>iloc[]</code> to find the row matching the <code>home_city</code> name. Since <code>iloc[]</code> uses index, the <em>0</em> here refers to the first row.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">home_city <span class="op">=</span> <span class="st">&#39;Bengaluru&#39;</span>
filtered <span class="op">=</span> country_df[country_df[<span class="st">&#39;city_ascii&#39;</span>] <span class="op">==</span> home_city]
<span class="bu">print</span>(filtered.iloc[<span class="dv">0</span>])</code></pre></div>
<pre><code>city           Bengalūru
city_ascii     Bengaluru
lat                12.97
lng                77.56
country            India
iso2                  IN
iso3                 IND
admin_name     Karnātaka
capital            admin
population     6.787e+06
id            1356410365
Name: 36, dtype: object</code></pre>
<p>Now that we have filtered down the data to a single row, we can select individual column values using column names.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">home_city_coordinates <span class="op">=</span> (filtered.iloc[<span class="dv">0</span>][<span class="st">&#39;lat&#39;</span>], filtered.iloc[<span class="dv">0</span>][<span class="st">&#39;lng&#39;</span>])
<span class="bu">print</span>(home_city_coordinates)</code></pre></div>
<pre><code>(12.97, 77.56)</code></pre>
</div>
<div id="performing-calculations" class="section level2">
<h2>Performing calculations</h2>
<p>Let’s learn how to do calculations on a dataframe. We can iterate over each row and perform some calculations. But pandas provide a much more efficient way. You can use the <code>apply()</code> method to run a function on each row. This is fast and makes it easy to complex computations on large datasets.</p>
<p>The <code>apply()</code> function takes 2 arguments. A function to apply, and the axis along which to apply it. <code>axis=0</code> means it will be applied to columns and <code>axis=1</code> means it will apply to rows.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> geopy <span class="im">import</span> distance

<span class="kw">def</span> calculate_distance(row):
    city_coordinates <span class="op">=</span> (row[<span class="st">&#39;lat&#39;</span>], row[<span class="st">&#39;lng&#39;</span>])
    <span class="cf">return</span> distance.geodesic(city_coordinates, home_city_coordinates).km

result <span class="op">=</span> country_df.<span class="bu">apply</span>(calculate_distance, axis<span class="op">=</span><span class="dv">1</span>)
<span class="bu">print</span>(result)</code></pre></div>
<pre><code>3        837.185709
5       1738.638856
7       1552.637823
34       295.340107
36         0.000000
           ...     
7305     230.567496
7441    2312.574457
7583    2383.154991
7681    2195.314732
9384    1106.693243
Length: 212, dtype: float64</code></pre>
<p>We can add these results to the dataframe by simply assigning the result to a new column.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">country_df[<span class="st">&#39;distance&#39;</span>] <span class="op">=</span> result
<span class="bu">print</span>(country_df)</code></pre></div>
<pre><code>           city city_ascii      lat      lng country iso2 iso3  \
3        Mumbai     Mumbai  19.0170  72.8570   India   IN  IND   
5         Delhi      Delhi  28.6700  77.2300   India   IN  IND   
7       Kolkata    Kolkata  22.4950  88.3247   India   IN  IND   
34      Chennai    Chennai  13.0900  80.2800   India   IN  IND   
36    Bengalūru  Bengaluru  12.9700  77.5600   India   IN  IND   
...         ...        ...      ...      ...     ...  ...  ...   
7305      Karūr      Karur  10.9504  78.0833   India   IN  IND   
7441     Jorhāt     Jorhat  26.7500  94.2167   India   IN  IND   
7583      Sopur      Sopur  34.3000  74.4667   India   IN  IND   
7681     Tezpur     Tezpur  26.6338  92.8000   India   IN  IND   
9384        Diu        Diu  20.7197  70.9904   India   IN  IND   

             admin_name capital  population          id     distance  
3           Mahārāshtra   admin  18978000.0  1356226629   837.185709  
5                 Delhi   admin  15926000.0  1356872604  1738.638856  
7           West Bengal   admin  14787000.0  1356060520  1552.637823  
34          Tamil Nādu    admin   7163000.0  1356374944   295.340107  
36            Karnātaka   admin   6787000.0  1356410365     0.000000  
...                 ...     ...         ...         ...          ...  
7305        Tamil Nādu      NaN     76915.0  1356837900   230.567496  
7441              Assam     NaN     69033.0  1356638741  2312.574457  
7583  Jammu and Kashmīr     NaN     63035.0  1356978065  2383.154991  
7681              Assam     NaN     58851.0  1356299437  2195.314732  
9384      Damān and Diu     NaN     23779.0  1356923516  1106.693243  

[212 rows x 12 columns]</code></pre>
<p>We are done with our analysis and ready to save the results. We can further filter the results to only certain columns.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">filtered <span class="op">=</span> country_df[[<span class="st">&#39;city_ascii&#39;</span>,<span class="st">&#39;distance&#39;</span>]]
<span class="bu">print</span>(filtered)</code></pre></div>
<pre><code>     city_ascii     distance
3        Mumbai   837.185709
5         Delhi  1738.638856
7       Kolkata  1552.637823
34      Chennai   295.340107
36    Bengaluru     0.000000
...         ...          ...
7305      Karur   230.567496
7441     Jorhat  2312.574457
7583      Sopur  2383.154991
7681     Tezpur  2195.314732
9384        Diu  1106.693243

[212 rows x 2 columns]</code></pre>
<p>Let’s rename the <code>city_ascii</code> column to give it a more readable name.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">filtered <span class="op">=</span> filtered.rename(columns <span class="op">=</span> {<span class="st">&#39;city_ascii&#39;</span>: <span class="st">&#39;city&#39;</span>})
<span class="bu">print</span>(filtered)</code></pre></div>
<pre><code>           city     distance
3        Mumbai   837.185709
5         Delhi  1738.638856
7       Kolkata  1552.637823
34      Chennai   295.340107
36    Bengaluru     0.000000
...         ...          ...
7305      Karur   230.567496
7441     Jorhat  2312.574457
7583      Sopur  2383.154991
7681     Tezpur  2195.314732
9384        Diu  1106.693243

[212 rows x 2 columns]</code></pre>
<p>Now that we have added filtered the original data and computed the distance for all cities, we can save the resulting dataframe to a file. Similar to read methods, Pandas have several write methods, such as <code>to_csv()</code>, <code>to_excel()</code> etc.</p>
<p>Here we will use the <code>to_csv()</code> method to write a CSV file. Pandas assigns an index column (unique integer values) to a dataframe by default. We specify <code>index=False</code> so that this index is not added to our output.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">output_filename <span class="op">=</span> <span class="st">&#39;cities_distance_pandas.csv&#39;</span>
output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span>
output_path <span class="op">=</span> os.path.join(output_dir, output_filename)
filtered.to_csv(output_path, index<span class="op">=</span><span class="va">False</span>)
<span class="bu">print</span>(<span class="st">&#39;Successfully written output file at </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(output_path))</code></pre></div>
</div>
<div id="exercise-10" class="section level2">
<h2>Exercise</h2>
<p>You will notice that the output file contains a row with the <code>home_city</code> as well. Modify the <code>filtered</code> dataframe to remove this row and write it to a file.</p>
<p>Hint: Use the Boolean filtering method we learnt earlier to select rows that do not match the <code>home_city</code>.</p>
<hr />

</div>
</div>
<div id="working-with-geopandas" class="section level1">
<h1>Working with Geopandas</h1>
<p>GeoPandas extends the Pandas library to enable spatial operations. It provides new data types such as <strong>GeoDataFrame</strong> and <strong>GeoSeries</strong> which are subclasses of Pandas <strong>DataFrame</strong> and <strong>Series</strong> and enables efficient vector data processing in Python.</p>
<p>GeoPandas make use of many other widely used spatial libraries - but it provides an interface similar to Pandas that make it intuitive to use it with spatial analysis. GeoPandas is built on top of the following libraries that allow it to be spatially aware.</p>
<ul>
<li><a href="https://shapely.readthedocs.io/en/latest/manual.html">Shapely</a> for geometric operations (i.e. buffer, intersections etc.)</li>
<li><a href="https://pyproj4.github.io/pyproj/stable/index.html">PyProj</a> for working with projections</li>
<li><a href="https://pypi.org/project/Fiona/">Fiona</a> for file input and output, which itself is based on the widely used <a href="https://gdal.org/">GDAL/OGR</a> library</li>
</ul>
<p>We will carry out a geoprocessing task that shows various features of this library and show how to do geo data processing in Python. The task is to take a roads data layer from OpenStreetMap and compute the total length of National Highways for each district in a state. The problem is described in detail in my <a href="https://courses.spatialthoughts.com/advanced-qgis.html#exercise-find-the-length-of-national-highways-in-a-state">Advanced QGIS</a> course and show the steps needed to perform this analysis in QGIS. We will replicate this example in Python.</p>
<div class="figure">
<img src="images/python_foundation/karnataka.png" />

</div>
<p>By convention, <code>geopandas</code> is commonly imported as <code>gpd</code></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> geopandas <span class="im">as</span> gpd</code></pre></div>
<div id="reading-spatial-data" class="section level2">
<h2>Reading Spatial Data</h2>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> os
data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span>
filename <span class="op">=</span> <span class="st">&#39;karnataka.gpkg&#39;</span>
path <span class="op">=</span> os.path.join(data_pkg_path, filename)</code></pre></div>
<p>GeoPandas has a <code>read_file()</code> method that is able to open a wide variety of vector datasets, including zip files. Here we will open the GeoPackage <code>karnataka.gpkg</code> and read a layer called <code>karnataka_major_roads</code>. The result of the read method is a <strong>GeoDataFrame</strong>.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">roads_gdf <span class="op">=</span> gpd.read_file(path, layer<span class="op">=</span><span class="st">&#39;karnataka_major_roads&#39;</span>)
<span class="bu">print</span>(roads_gdf.info())</code></pre></div>
<pre><code>&lt;class &#39;geopandas.geodataframe.GeoDataFrame&#39;&gt;
RangeIndex: 44606 entries, 0 to 44605
Data columns (total 11 columns):
 #   Column    Non-Null Count  Dtype   
---  ------    --------------  -----   
 0   osm_id    44606 non-null  object  
 1   code      44606 non-null  int64   
 2   fclass    44606 non-null  object  
 3   name      7018 non-null   object  
 4   ref       7702 non-null   object  
 5   oneway    44606 non-null  object  
 6   maxspeed  44606 non-null  int64   
 7   layer     44606 non-null  int64   
 8   bridge    44606 non-null  object  
 9   tunnel    44606 non-null  object  
 10  geometry  44606 non-null  geometry
dtypes: geometry(1), int64(3), object(7)
memory usage: 3.7+ MB
None</code></pre>
<p>A GeoDataFrame contains a special column called <em>geometry</em>. All spatial operations on the GeoDataFrame are applied to the geomety column. The geometry column can be accessed using the <code>geometry</code> attribute.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(roads_gdf.geometry)</code></pre></div>
<pre><code>0        MULTILINESTRING ((77.59928 12.97672, 77.59950 ...
1        MULTILINESTRING ((76.65944 12.31809, 76.65904 ...
2        MULTILINESTRING ((76.65906 12.31389, 76.65912 ...
3        MULTILINESTRING ((76.65600 12.30895, 76.65646 ...
4        MULTILINESTRING ((76.65615 12.30989, 76.65600 ...
                               ...                        
44601    MULTILINESTRING ((77.60806 12.97517, 77.60797 ...
44602    MULTILINESTRING ((77.60798 12.97519, 77.60806 ...
44603    MULTILINESTRING ((77.57115 13.00849, 77.57156 ...
44604    MULTILINESTRING ((77.70140 12.95693, 77.70164 ...
44605    MULTILINESTRING ((77.61040 12.97360, 77.61052 ...
Name: geometry, Length: 44606, dtype: geometry</code></pre>
</div>
<div id="filtering-data-1" class="section level2">
<h2>Filtering Data</h2>
<p>One can use the standard Pandas filtering methods to select a subset of the GeoDataFrame. In addition, GeoPandas also provide way to subset the data based on a bounding box with the <a href="https://geopandas.readthedocs.io/en/latest/indexing.html"><code>cx[]</code> indexer</a>.</p>
<p>For our analysis, we need to apply a filter to extract only the road segments where the <code>ref</code> attribute starts with <strong>‘NH’</strong> - indicating a national highway. We can apply boolean filtering using Panda’s <code>str.match()</code> method with a regular expression.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">filtered <span class="op">=</span> roads_gdf[roads_gdf[<span class="st">&#39;ref&#39;</span>].<span class="bu">str</span>.match(<span class="st">&#39;^NH&#39;</span>) <span class="op">==</span> <span class="va">True</span>]
<span class="bu">print</span>(filtered.head())</code></pre></div>
<pre><code>      osm_id  code fclass                        name    ref oneway  maxspeed  \
17   8684837  5112  trunk  Bengaluru - Mangaluru Road  NH373      F         0   
26   9951034  5112  trunk                        None  NH948      B        50   
54  22838314  5112  trunk   Solapur-Mangalore Highway  NH169      B         0   
55  22838318  5112  trunk                        None   NH66      B         0   
56  22838318  5112  trunk                        None   NH66      B         0   

    layer bridge tunnel                                           geometry  
17      0      F      F  MULTILINESTRING ((76.10024 13.00326, 76.09950 ...  
26      0      F      F  MULTILINESTRING ((77.16472 12.24774, 77.16416 ...  
54      0      F      F  MULTILINESTRING ((74.86387 12.88387, 74.86419 ...  
55      0      F      F  MULTILINESTRING ((74.78756 13.09142, 74.78744 ...  
56      0      F      F  MULTILINESTRING ((74.78767 13.09723, 74.78767 ...  </code></pre>
</div>
<div id="working-with-projections" class="section level2">
<h2>Working with Projections</h2>
<p>Dealing with projetions is a key aspect of working with spatial data. GeoPandas uses the <code>pyproj</code> library to assign and manage projections. Each GeoDataFrame as a <code>crs</code> attribute that contains the projection info. Our source dataset is in EPSG:4326 WGS84 CRS.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(filtered.crs)</code></pre></div>
<pre><code>epsg:4326</code></pre>
<p>Since our task is to compute line lengths, we need to use a Projected CRS. We can use the <code>to_crs()</code> method to reproject the GeoDataFrame.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">roads_reprojected <span class="op">=</span> filtered.to_crs(<span class="st">&#39;EPSG:32643&#39;</span>)
<span class="bu">print</span>(roads_reprojected.crs)</code></pre></div>
<pre><code>EPSG:32643</code></pre>
<p>Now that the layer has been reprojected, we can calculate the length of each geometry using the <code>length</code> attribute. The result would be in meters. We can add the line lengths in a new column named <code>length</code>.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">roads_reprojected[<span class="st">&#39;length&#39;</span>] <span class="op">=</span> roads_reprojected[<span class="st">&#39;geometry&#39;</span>].length</code></pre></div>
<p>We can apply statistical operations on a DataFrame columns. Here we can compute the total length of national highways in the state by calling the <code>sum()</code> method.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">total_length <span class="op">=</span> roads_reprojected[<span class="st">&#39;length&#39;</span>].<span class="bu">sum</span>()
<span class="bu">print</span>(<span class="st">&#39;Total length of national highways in the state is </span><span class="sc">{}</span><span class="st"> KM&#39;</span>.<span class="bu">format</span>(total_length<span class="op">/</span><span class="dv">1000</span>))</code></pre></div>
<pre><code>Total length of national highways in the state is 8616.166058402967 KM</code></pre>
</div>
<div id="performing-spatial-joins" class="section level2">
<h2>Performing Spatial joins</h2>
<p>There are two ways to combine datasets in geopandas – table joins and spatial joins. For our task, we need information about which district each road segments belongs to. This can be achived using another spatial layer for the districts and doing a spatial join to transfer the attributes of the district layer to the matching road segment.</p>
<p>The <code>karnataka.gpkg</code> contains a layer called <code>karnataka_districts</code> with the district boundaries and names.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">districts_gdf <span class="op">=</span> gpd.read_file(path, layer<span class="op">=</span><span class="st">&#39;karnataka_districts&#39;</span>)
<span class="bu">print</span>(districts_gdf.head())</code></pre></div>
<pre><code>          DISTRICT      ST_NM  ST_CEN_CD  DT_CEN_CD  censuscode  \
0         Bagalkot  Karnataka         29          2         556   
1  Bangalore Rural  Karnataka         29         29         583   
2        Bangalore  Karnataka         29         18         572   
3          Belgaum  Karnataka         29          1         555   
4          Bellary  Karnataka         29         11         565   

                                            geometry  
0  MULTIPOLYGON (((76.24100 16.16531, 76.23538 16...  
1  MULTIPOLYGON (((77.38701 13.50002, 77.40099 13...  
2  MULTIPOLYGON (((77.83549 12.86809, 77.83213 12...  
3  MULTIPOLYGON (((75.02647 16.93264, 75.02827 16...  
4  MULTIPOLYGON (((77.15757 15.13706, 77.15887 15...  </code></pre>
<p>Before joining this layer to the roads, we must reproject it to match the CRS of the roads layer.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">districts_reprojected <span class="op">=</span> districts_gdf.to_crs(<span class="st">&#39;EPSG:32643&#39;</span>)</code></pre></div>
<p>A spatial join is performed using the <code>sjoin()</code> method. It takes 2 core arguments.</p>
<ul>
<li><code>op</code>: The spatial predicate to decdie which objects to join. Options are <em>intersects</em>, <em>within</em> and <em>contains</em>.</li>
<li><code>how</code>: The type of join to perform. Options are <em>left</em>, <em>right</em> and <em>inner</em>.</li>
</ul>
<p>For our task, we can do a <em>left</em> join and add attributes of the district that <em>intersect</em> the road.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">joined <span class="op">=</span> gpd.sjoin(roads_reprojected, districts_reprojected, how<span class="op">=</span><span class="st">&#39;left&#39;</span>, op<span class="op">=</span><span class="st">&#39;intersects&#39;</span>)
<span class="bu">print</span>(joined.head())</code></pre></div>
<pre><code>      osm_id  code fclass                        name    ref oneway  maxspeed  \
17   8684837  5112  trunk  Bengaluru - Mangaluru Road  NH373      F         0   
26   9951034  5112  trunk                        None  NH948      B        50   
54  22838314  5112  trunk   Solapur-Mangalore Highway  NH169      B         0   
55  22838318  5112  trunk                        None   NH66      B         0   
55  22838318  5112  trunk                        None   NH66      B         0   

    layer bridge tunnel                                           geometry  \
17      0      F      F  MULTILINESTRING ((619317.005 1437753.696, 6192...   
26      0      F      F  MULTILINESTRING ((735483.761 1354892.067, 7354...   
54      0      F      F  MULTILINESTRING ((485231.162 1424297.721, 4852...   
55      0      F      F  MULTILINESTRING ((476971.413 1447255.675, 4769...   
55      0      F      F  MULTILINESTRING ((476971.413 1447255.675, 4769...   

          length  index_right          DISTRICT      ST_NM  ST_CEN_CD  \
17   2352.939132         16.0            Hassan  Karnataka       29.0   
26  12876.925507          7.0      Chamrajnagar  Karnataka       29.0   
54    822.021433         11.0  Dakshina Kannada  Karnataka       29.0   
55    648.925208         11.0  Dakshina Kannada  Karnataka       29.0   
55    648.925208         27.0             Udupi  Karnataka       29.0   

    DT_CEN_CD  censuscode  
17       20.0       574.0  
26       24.0       578.0  
54       21.0       575.0  
55       21.0       575.0  
55       15.0       569.0  </code></pre>
</div>
<div id="group-statistics" class="section level2">
<h2>Group Statistics</h2>
<p>The resulting geodataframe now has the matching column from the intersecting district feature. We can now sum the length of the roads and group them by districts. This type of <em>Group Statistics</em> is performed using Panda’s <code>group_by()</code> method.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">results <span class="op">=</span> joined.groupby(<span class="st">&#39;DISTRICT&#39;</span>)[<span class="st">&#39;length&#39;</span>].<span class="bu">sum</span>()<span class="op">/</span><span class="dv">1000</span>
<span class="bu">print</span>(results)</code></pre></div>
<pre><code>DISTRICT
Bagalkot            258.449475
Bangalore           311.445505
Bangalore Rural     320.036790
Belgaum             528.922528
Bellary             304.789522
Bidar               247.348300
Bijapur             424.197281
Chamrajnagar        217.737255
Chikkaballapura     211.957819
Chikmagalur         334.423573
Chitradurga         531.932443
Dakshina Kannada    316.339566
Davanagere          177.877407
Dharwad             314.978752
Gadag               111.548768
Gulbarga            294.551578
Hassan              436.231356
Haveri              306.582730
Kodagu               63.806864
Kolar               221.598406
Koppal              288.358711
Mandya              337.617829
Mysore              359.862216
Raichur             167.746669
Ramanagara          199.426362
Shimoga             479.140995
Tumkur              613.177564
Udupi               277.331577
Uttara Kannada      424.184040
Yadgir              144.858328
Name: length, dtype: float64</code></pre>
<p>The result of the <code>group_by()</code> method is a Pandas <em>Series</em>. It can be saved to a CSV file using the <code>to_csv()</code> method.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">output_filename <span class="op">=</span> <span class="st">&#39;national_highways_by_districts.csv&#39;</span>
output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span>
output_path <span class="op">=</span> os.path.join(output_dir, output_filename)
results.to_csv(output_path)
<span class="bu">print</span>(<span class="st">&#39;Successfully written output file at </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(output_path))</code></pre></div>
<pre><code>Successfully written output file at output/national_highways_by_districts.csv</code></pre>
</div>
<div id="exercise-11" class="section level2">
<h2>Exercise</h2>
<p>Before writing the output to the file, round the distance numbers to a whole number.</p>
<hr />

<p>Open the notebook named <code>13_creating_spatial_data.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="creating-spatial-data" class="section level1">
<h1>Creating Spatial Data</h1>
<p>A common operation in spatial analysis is to take non-spatial data, such as CSV files, and creating a spatial dataset from it using coordinate information contained in the file. GeoPandas provides a convenient way to take data from a delimited-text file, create geometry and write the results as a spatial dataset.</p>
<p>We will read a tab-delimited file of places, filter it to a feature class, create a GeoDataFrame and export it as a GeoPackage file.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> os
<span class="im">import</span> pandas <span class="im">as</span> pd
<span class="im">import</span> geopandas <span class="im">as</span> gpd</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">data_pkg_path <span class="op">=</span> <span class="st">&#39;data/geonames/&#39;</span>
filename <span class="op">=</span> <span class="st">&#39;US.txt&#39;</span>
path <span class="op">=</span> os.path.join(data_pkg_path, filename)</code></pre></div>
<div id="reading-tab-delimited-files" class="section level2">
<h2>Reading Tab-Delimited Files</h2>
<p>The source data comes from <a href="https://en.wikipedia.org/wiki/GeoNames">GeoNames</a> - a free and open database of geographic names of the world. It is a huge database containing millions of records per country. The data is distributed as country-level text files in a tab-delimited format. The files do not contain a header row with column names, so we need to specify them when reading the data. The data format is described in detail on the <a href="https://www.geonames.org/export/">Data Export</a> page.</p>
<p>We specify the separator as <strong>\t</strong> (tab) as an argument to the <code>read_csv()</code> method. Note that the file for USA has more than 2M records.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">column_names <span class="op">=</span> [
    <span class="st">&#39;geonameid&#39;</span>, <span class="st">&#39;name&#39;</span>, <span class="st">&#39;asciiname&#39;</span>, <span class="st">&#39;alternatenames&#39;</span>, 
    <span class="st">&#39;latitude&#39;</span>, <span class="st">&#39;longitude&#39;</span>, <span class="st">&#39;feature class&#39;</span>, <span class="st">&#39;feature code&#39;</span>,
    <span class="st">&#39;country code&#39;</span>, <span class="st">&#39;cc2&#39;</span>, <span class="st">&#39;admin1 code&#39;</span>, <span class="st">&#39;admin2 code&#39;</span>,
    <span class="st">&#39;admin3 code&#39;</span>, <span class="st">&#39;admin4 code&#39;</span>, <span class="st">&#39;population&#39;</span>, <span class="st">&#39;elevation&#39;</span>,
    <span class="st">&#39;dem&#39;</span>, <span class="st">&#39;timezone&#39;</span>, <span class="st">&#39;modification date&#39;</span>
]

df <span class="op">=</span> pd.read_csv(path, sep<span class="op">=</span><span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>, names<span class="op">=</span>column_names)
<span class="bu">print</span>(df.info())</code></pre></div>
<pre><code>/Users/ujaval/opt/anaconda3/envs/python_foundation/lib/python3.7/site-packages/IPython/core/interactiveshell.py:3063: DtypeWarning: Columns (9,11) have mixed types.Specify dtype option on import or set low_memory=False.
  interactivity=interactivity, compiler=compiler, result=result)


&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2237861 entries, 0 to 2237860
Data columns (total 19 columns):
 #   Column             Dtype  
---  ------             -----  
 0   geonameid          int64  
 1   name               object 
 2   asciiname          object 
 3   alternatenames     object 
 4   latitude           float64
 5   longitude          float64
 6   feature class      object 
 7   feature code       object 
 8   country code       object 
 9   cc2                object 
 10  admin1 code        object 
 11  admin2 code        object 
 12  admin3 code        float64
 13  admin4 code        float64
 14  population         int64  
 15  elevation          float64
 16  dem                int64  
 17  timezone           object 
 18  modification date  object 
dtypes: float64(5), int64(3), object(11)
memory usage: 324.4+ MB
None</code></pre>
</div>
<div id="filtering-data-2" class="section level2">
<h2>Filtering Data</h2>
<p>The input data as a column <code>feature_class</code> categorizing the place into <a href="https://www.geonames.org/export/codes.html">9 feature classes</a>. We can select all rows with the value <code>T</code> with the category <em>mountain,hill,rock…</em></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">mountains <span class="op">=</span> df[df[<span class="st">&#39;feature class&#39;</span>]<span class="op">==</span><span class="st">&#39;T&#39;</span>]
<span class="bu">print</span>(mountains.head()[[<span class="st">&#39;name&#39;</span>, <span class="st">&#39;latitude&#39;</span>, <span class="st">&#39;longitude&#39;</span>, <span class="st">&#39;dem&#39;</span>,<span class="st">&#39;feature class&#39;</span>]])</code></pre></div>
<pre><code>                 name  latitude  longitude   dem feature class
15       Vulcan Point  52.10222  177.53889 -9999             T
16     Tropical Ridge  51.99167  177.50833   267             T
17  Thirty-Seven Hill  52.84528  173.15278   193             T
20       Square Point  52.86120  173.33679    30             T
21       Square Bluff  51.65000  178.70000 -9999             T</code></pre>
</div>
<div id="creating-geometries" class="section level2">
<h2>Creating Geometries</h2>
<p>GeoPandas has a conveinent function <code>points_from_xy()</code> that creates a Geometry column from X and Y coordinates. We can then take a Pandas dataframe and create a GeoDataFrame by specifying a CRS and the geometry column.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">geometry <span class="op">=</span> gpd.points_from_xy(mountains.longitude, mountains.latitude)
gdf <span class="op">=</span> gpd.GeoDataFrame(mountains, crs<span class="op">=</span><span class="st">&#39;EPSG:4326&#39;</span>, geometry<span class="op">=</span>geometry)
<span class="bu">print</span>(gdf.info())</code></pre></div>
<pre><code>&lt;class &#39;geopandas.geodataframe.GeoDataFrame&#39;&gt;
Int64Index: 225328 entries, 15 to 2237836
Data columns (total 20 columns):
 #   Column             Non-Null Count   Dtype   
---  ------             --------------   -----   
 0   geonameid          225328 non-null  int64   
 1   name               225328 non-null  object  
 2   asciiname          225328 non-null  object  
 3   alternatenames     30933 non-null   object  
 4   latitude           225328 non-null  float64 
 5   longitude          225328 non-null  float64 
 6   feature class      225328 non-null  object  
 7   feature code       225328 non-null  object  
 8   country code       225328 non-null  object  
 9   cc2                5 non-null       object  
 10  admin1 code        225327 non-null  object  
 11  admin2 code        225170 non-null  object  
 12  admin3 code        21646 non-null   float64 
 13  admin4 code        0 non-null       float64 
 14  population         225328 non-null  int64   
 15  elevation          224417 non-null  float64 
 16  dem                225328 non-null  int64   
 17  timezone           225273 non-null  object  
 18  modification date  225328 non-null  object  
 19  geometry           225328 non-null  geometry
dtypes: float64(5), geometry(1), int64(3), object(11)
memory usage: 36.1+ MB
None</code></pre>
</div>
<div id="writing-files-1" class="section level2">
<h2>Writing Files</h2>
<p>We can write the resulting GeoDataFrame to any of the supported vector data format. Here we are writing it as a new GeoPackage file.</p>
<p>You can open the resulting geopackage in a GIS and view the data.</p>
<div class="figure">
<img src="images/python_foundation/geonames_mountains.png" />

</div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span>
output_filename <span class="op">=</span> <span class="st">&#39;mountains.gpkg&#39;</span>
output_path <span class="op">=</span> os.path.join(output_dir, output_filename)

gdf.to_file(driver<span class="op">=</span><span class="st">&#39;GPKG&#39;</span>, filename<span class="op">=</span>output_path, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>)
<span class="bu">print</span>(<span class="st">&#39;Successfully written output file at </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(output_path))</code></pre></div>
<pre><code>Successfully written output file at output/mountains.gpkg</code></pre>
</div>
<div id="exercise-12" class="section level2">
<h2>Exercise</h2>
<p>The data package contains multiple geonames text files from different countries in the <code>geonames/</code> folder. Write code to read all the files, merge them and extract the mountain features to a single geopackage.</p>
<ul>
<li>Hint1: Use the <code>os.listdir()</code> method to get all files in a directory.</li>
<li>Hint2: Use the Pandas method <code>concat()</code> to merge multiple dataframes.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> os
<span class="im">import</span> pandas <span class="im">as</span> pd
<span class="im">import</span> geopandas <span class="im">as</span> gpd

data_pkg_path <span class="op">=</span> <span class="st">&#39;data/geonames/&#39;</span>
files <span class="op">=</span> os.listdir(data_pkg_path)

filepaths <span class="op">=</span> []
<span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:
    filepaths.append(os.path.join(data_pkg_path, <span class="bu">file</span>))
<span class="bu">print</span>(filepaths)

<span class="co"># Iterate over the files, read them using pandas and create a list of dataframes. </span>
<span class="co"># You can then use pd.concat() function to merge them</span></code></pre></div>
<pre><code>[&#39;data/geonames/US.txt&#39;, &#39;data/geonames/MX.txt&#39;, &#39;data/geonames/CA.txt&#39;]</code></pre>
<hr />

<p>Open the notebook named <code>14_introduction_to_numpy.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="introduction-to-numpy" class="section level1">
<h1>Introduction to NumPy</h1>
<p>NumPy (Numerical Python) is an important Python library for scientific computation. Libraries such as Pandas and GeoPandas are built on top of NumPy.</p>
<div class="figure">
<img src="images/python_foundation/numpy.png" alt="NumPy Logo" />
<p class="caption">NumPy Logo</p>
</div>
<p>It provides a fast and efficient ways to work with <em>Arrays</em>. In the domain of spatial data analysis, it plays a critical role in working with Raster data - such as satellite imagery, aerial photos, elevation data etc. Since the underlying structure of raster data is a 2D array for each band - learning NumPy is critical in processing raster data using Python.</p>
<p>By convention, <code>numpy</code> is commonly imported as <code>np</code></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> numpy <span class="im">as</span> np</code></pre></div>
<div id="arrays" class="section level2">
<h2>Arrays</h2>
<p>The array object in NumPy is called <code>ndarray</code>. It provides a lot of supporting functions that make working with arrays fast and easy. Arrays may seem like Python Lists, but <code>ndarray</code> is upto 50x faster in mathematical operations. You can create an array using the <code>array()</code> method. As you can see, the rsulting object is of type <code>numpy.ndarray</code></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">a <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])
<span class="bu">print</span>(<span class="bu">type</span>(a))</code></pre></div>
<pre><code>&lt;class &#39;numpy.ndarray&#39;&gt;</code></pre>
<p>Arrays can have any <em>dimensions</em>. We can create a 2D array like below. <code>ndarray</code> objects have the property <code>ndim</code> that stores the number of array dimensions. You can also check the array size using the <code>shape</code> property.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">b <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>], [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]])
<span class="bu">print</span>(b)
<span class="bu">print</span>(b.ndim)
<span class="bu">print</span>(b.shape)</code></pre></div>
<pre><code>[[1 2 4]
 [3 4 5]]
2
(2, 3)</code></pre>
<p>You can access elements of arrays like Python lists using <code>[]</code> notation.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(b[<span class="dv">0</span>])</code></pre></div>
<pre><code>[1 2 4]</code></pre>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(b[<span class="dv">0</span>][<span class="dv">2</span>])</code></pre></div>
<pre><code>4</code></pre>
</div>
<div id="array-operations" class="section level2">
<h2>Array Operations</h2>
<p>Mathematical operations on numpy arrays are easy and fast. NumPy as many built-in functions for common operations.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(np.<span class="bu">sum</span>(b))</code></pre></div>
<pre><code>19</code></pre>
<p>You can also use the functions operations on arrays.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">c <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>], [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>]])
<span class="bu">print</span>(np.divide(b, c))</code></pre></div>
<pre><code>[[0.5 1.  2. ]
 [1.5 2.  2.5]]</code></pre>
<p>If the objects are numpy objects, you can use the Python operators as well</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(b<span class="op">/</span>c)</code></pre></div>
<pre><code>[[0.5 1.  2. ]
 [1.5 2.  2.5]]</code></pre>
<p>You can also combine array and scalar objects. The scalar operation is applied to each item in the array.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(b)
<span class="bu">print</span>(b<span class="op">*</span><span class="dv">2</span>)
<span class="bu">print</span>(b<span class="op">/</span><span class="dv">2</span>)</code></pre></div>
<pre><code>[[1 2 4]
 [3 4 5]]
[[ 2  4  8]
 [ 6  8 10]]
[[0.5 1.  2. ]
 [1.5 2.  2.5]]</code></pre>
<p>An important concept in NumPy is the <em>Array Axes</em>. In a 2D array, Axis 0 is the direction of rows and Axis 1 is the direction of columns. <a href="https://www.sharpsightlabs.com/blog/numpy-axes-explained/">This article</a> provides a very good explanation of the concept.</p>
<p>Let’s see how we can apply a function on a specific axis. Here when we apply <code>sum</code> function on axis-0 of a 2D array, it gives us a 1D-array with values summed across rows.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(b)
row_sum <span class="op">=</span> b.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)
<span class="bu">print</span>(row_sum)</code></pre></div>
<pre><code>[[1 2 4]
 [3 4 5]]
[4 6 9]</code></pre>
</div>
<div id="exercise-13" class="section level2">
<h2>Exercise</h2>
<p>Sum the array <code>b</code> along Axis-1. What do you think will be the result?</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> numpy <span class="im">as</span> np

b <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>], [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]])
<span class="bu">print</span>(b)</code></pre></div>
<pre><code>[[1 2 4]
 [3 4 5]]</code></pre>
<hr />

<p>Open the notebook named <code>15_working_with_rasterio.ipynb</code>.</p>
<hr />
</div>
</div>
<div id="working-with-rasterio" class="section level1">
<h1>Working with RasterIO</h1>
<p><a href="https://rasterio.readthedocs.io/en/latest/">RasterIO</a> is a modern library to work with geospatial data in a gridded format. It excels at providing an easy way to read/write raster data and access individual bands and pixels as <code>numpy</code> arrays.</p>
<p>RasterIO is built on top of the popular <a href="https://gdal.org/">GDAL (Geospatial Data Abstraction Library)</a>. GDAL is written in C++ so the Python API provided by GDAL is not very intuitive for Python users. RaserIO aims to make it easy for Python users to use the underlying GDAL library in an intuitive way.</p>
<p>In this section, we will take 4 individual SRTM tiles around the Mt. Everest region and merge them to a single GeoTiff using RasterIO.</p>
<div class="figure">
<img src="images/python_foundation/srtm.png" />

</div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> rasterio</code></pre></div>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> os
data_pkg_path <span class="op">=</span> <span class="st">&#39;data&#39;</span>
srtm_dir <span class="op">=</span> <span class="st">&#39;srtm&#39;</span>
filename <span class="op">=</span> <span class="st">&#39;N28E087.hgt&#39;</span>
path <span class="op">=</span> os.path.join(data_pkg_path, srtm_dir, filename)</code></pre></div>
<div id="reading-raster-data" class="section level2">
<h2>Reading Raster Data</h2>
<p>RasterIO can read any raster format supported by the GDAL library. We can call the <code>open()</code> method with the file path of the raster. The resulting dataset behaves much like Python’s File object.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">dataset <span class="op">=</span> rasterio.<span class="bu">open</span>(path)</code></pre></div>
<p>You can check information about the raster using the <code>meta</code> attribute.</p>
<p>An important property is the dataset <em>transform</em>. The transform contains the pixel resolution of the dataset and the row and column coordinates of the upper left corner of the dataset.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">metadata <span class="op">=</span> dataset.meta
metadata</code></pre></div>
<pre><code>{&#39;driver&#39;: &#39;SRTMHGT&#39;,
 &#39;dtype&#39;: &#39;int16&#39;,
 &#39;nodata&#39;: -32768.0,
 &#39;width&#39;: 3601,
 &#39;height&#39;: 3601,
 &#39;count&#39;: 1,
 &#39;crs&#39;: CRS.from_epsg(4326),
 &#39;transform&#39;: Affine(0.0002777777777777778, 0.0, 86.99986111111112,
        0.0, -0.0002777777777777778, 29.000138888888888)}</code></pre>
<p>To read the pixel values, we need to call the <code>read()</code> method by passing it a band’s index number. Following the GDAL convention, bands are indexed from 1. Since our dataset contain just 1-band, we can read it as follows.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">band1 <span class="op">=</span> dataset.read(<span class="dv">1</span>)
<span class="bu">print</span>(band1)</code></pre></div>
<pre><code>[[5217 5211 5208 ... 5097 5098 5089]
 [5206 5201 5200 ... 5080 5075 5069]
 [5199 5194 5191 ... 5063 5055 5048]
 ...
 [5347 5345 5343 ... 5747 5750 5757]
 [5338 5338 5336 ... 5737 5740 5747]
 [5332 5331 5332 ... 5734 5736 5744]]</code></pre>
<p>Finally, when we are done with the dataset, we must close it. It is especially important when writing a dataset.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">dataset.close()</code></pre></div>
</div>
<div id="merging-datasets" class="section level2">
<h2>Merging Datasets</h2>
<p>Let’s see how we can read the 4 individual tiles and mosaic them together. RasterIO provides multiple sub-modules for various raster operations. We can use the <code>rasterio.merge</code> module to carry out this operation.</p>
<p>We first find all the individual files in the directory using the <code>os.listdir()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">srtm_path <span class="op">=</span> os.path.join(data_pkg_path, <span class="st">&#39;srtm&#39;</span>)
all_files <span class="op">=</span> os.listdir(srtm_path)
<span class="bu">print</span>(all_files)</code></pre></div>
<pre><code>[&#39;N28E086.hgt&#39;, &#39;N28E087.hgt&#39;, &#39;N27E087.hgt&#39;, &#39;N27E086.hgt&#39;]</code></pre>
<p>The rasterio.merge module has a <code>merge()</code> method that takes a list of <em>datasets</em> and returns the merged dataset. So we create an empty list, open each of the files and append it to the list.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">dataset_list <span class="op">=</span> []
<span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> all_files:
    path <span class="op">=</span> os.path.join(srtm_path, <span class="bu">file</span>)
    dataset_list.append(rasterio.<span class="bu">open</span>(path))
<span class="bu">print</span>(dataset_list)</code></pre></div>
<pre><code>[&lt;open DatasetReader name=&#39;data/srtm/N28E086.hgt&#39; mode=&#39;r&#39;&gt;, &lt;open DatasetReader name=&#39;data/srtm/N28E087.hgt&#39; mode=&#39;r&#39;&gt;, &lt;open DatasetReader name=&#39;data/srtm/N27E087.hgt&#39; mode=&#39;r&#39;&gt;, &lt;open DatasetReader name=&#39;data/srtm/N27E086.hgt&#39; mode=&#39;r&#39;&gt;]</code></pre>
<p>We can pass on the list of tile dataset to the merge method, which will return us the merged data and a new <em>transform</em> which contains the updated extent of the merged raster.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> rasterio <span class="im">import</span> merge
merged_result <span class="op">=</span> merge.merge(dataset_list)
<span class="bu">print</span>(merged_result)</code></pre></div>
<pre><code>(array([[[  4916,   4926,   4931, ...,   5098,   5089, -32768],
        [  4919,   4932,   4928, ...,   5075,   5069, -32768],
        [  4919,   4928,   4935, ...,   5055,   5048, -32768],
        ...,
        [   364,    364,    362, ...,   1930,   1944, -32768],
        [   360,    359,    357, ...,   1930,   1942, -32768],
        [-32768, -32768, -32768, ..., -32768, -32768, -32768]]],
      dtype=int16), Affine(0.0002777777777777778, 0.0, 85.99986111111112,
       0.0, -0.0002777777777777778, 29.000138888888888))</code></pre>
<p>We save the data and the transform to separate variables.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">merged_data <span class="op">=</span> merged_result[<span class="dv">0</span>]
merged_transform <span class="op">=</span> merged_result[<span class="dv">1</span>]</code></pre></div>
<p>Verify that the resulting array shape the sum of individual rasters</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="bu">print</span>(merged_data.shape)</code></pre></div>
<pre><code>(1, 7202, 7202)</code></pre>
</div>
<div id="writing-raster-data" class="section level2">
<h2>Writing Raster Data</h2>
<p>Similar to regular Python files, to create a new file, we can open the output file in the <em>write</em> mode. RasterIO provides a <code>write()</code> method that we can use to write individual bands.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">output_filename <span class="op">=</span> <span class="st">&#39;merged.tif&#39;</span>
output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span>
output_path <span class="op">=</span> os.path.join(output_dir, output_filename)</code></pre></div>
<p>We need to specify many metadata parameters to initialize the output dataset. Some of these parameter values can be directly copied from the input files, such as <code>crs</code>, <code>dtype</code>, <code>nodata</code> etc. , while others can be obtained from the merged dataset, such as <code>height</code> and <code>width</code>.</p>
<p>Remember to call the <code>close()</code> method which will finalize the file and write the data to disk.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">new_dataset <span class="op">=</span> rasterio.<span class="bu">open</span>(output_path, <span class="st">&#39;w&#39;</span>, 
                            driver<span class="op">=</span><span class="st">&#39;GTiff&#39;</span>,
                            height<span class="op">=</span>merged_data.shape[<span class="dv">1</span>],
                            width<span class="op">=</span>merged_data.shape[<span class="dv">2</span>],
                            count<span class="op">=</span><span class="dv">1</span>,
                            nodata<span class="op">=-</span><span class="fl">32768.0</span>,
                            dtype<span class="op">=</span>merged_data.dtype,
                            crs<span class="op">=</span><span class="st">&#39;+proj=latlong&#39;</span>,
                            transform<span class="op">=</span>merged_transform)
new_dataset.write(merged_data)
new_dataset.close()
<span class="bu">print</span>(<span class="st">&#39;Successfully written output file at </span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(output_path))</code></pre></div>
<pre><code>Successfully written output file at output/merged.tif</code></pre>
</div>
<div id="exercise-14" class="section level2">
<h2>Exercise</h2>
<p>The merged array represents elevation values. The extent of the tiles cover Mt. Everest. Read the resulting raster and find the maximum elevation value contained in it.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> rasterio
<span class="im">import</span> os
<span class="im">import</span> numpy <span class="im">as</span> np

output_filename <span class="op">=</span> <span class="st">&#39;merged.tif&#39;</span>
output_dir <span class="op">=</span> <span class="st">&#39;output&#39;</span>
output_path <span class="op">=</span> os.path.join(output_dir, output_filename)

<span class="co"># Read the output file as a NumPy array and find the maximum value</span></code></pre></div>
<hr />

</div>
</div>
<div id="writing-standalone-python-scripts" class="section level1">
<h1>Writing Standalone Python Scripts</h1>
<p>So far we have used Jupyter Notebooks to write and execute Python code. A notebook is a great choice to interactively explore, visualize and document workflows. But they are not suited for writing scripts for automation. If you have tasks that are long running or want to execute certain tasks on a schedule, you have to write scripts in a standalone <code>.py</code> file and run it from a Terminal or Console.</p>
<div id="get-a-text-editor" class="section level2">
<h2>Get a Text Editor</h2>
<p>Any kind of software development requires a good text editor. If you already have a favorite text editor or an IDE (Integrated Development Environment), you may use it for this course. Otherwise, each platform offers a wide variety of free or paid options for text editors. Choose the one that fits your needs.</p>
<p>Below are my recommendations editors that are simple to use for beginners.</p>
<ul>
<li>Windows: <a href="https://notepad-plus-plus.org/downloads/">Notepad++</a> is a good free editor for windows. Download and install the Notepad++ editor. Tip: Before writing Python code in Notepad+++, make sure to go to Settings → Preferences → Tab Settings and enable <code>Replace by space</code>. Python is very sensitive about whitespace and this setting will ensure tabs and spaces are treated properly.</li>
<li>Mac: <a href="https://macromates.com/">TextMate</a> is an open-source editor for Mac that is currently available for free.</li>
</ul>
</div>
<div id="writing-a-script" class="section level2">
<h2>Writing a Script</h2>
<p>Copy the following code and paste it in your text editor. Browse to the data package directory and save the file as <code>get_distance.py</code>. Make sure that there is no <code>.txt</code> extension at the end.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">from</span> geopy <span class="im">import</span> distance

san_francisco <span class="op">=</span> (<span class="fl">37.7749</span>, <span class="op">-</span><span class="fl">122.4194</span>)
new_york <span class="op">=</span> (<span class="fl">40.661</span>, <span class="op">-</span><span class="fl">73.944</span>)

ellipsoid_distance <span class="op">=</span> distance.geodesic(san_francisco, new_york, ellipsoid<span class="op">=</span><span class="st">&#39;WGS-84&#39;</span>).km

<span class="bu">print</span>(<span class="st">&#39;Source Coordinates: </span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(san_francisco[<span class="dv">0</span>], san_francisco[<span class="dv">1</span>]))
<span class="bu">print</span>(<span class="st">&#39;Destination Coordinates: </span><span class="sc">{}</span><span class="st">,</span><span class="sc">{}</span><span class="st">&#39;</span>.<span class="bu">format</span>(san_francisco[<span class="dv">0</span>], san_francisco[<span class="dv">1</span>]))
<span class="bu">print</span>(<span class="st">&#39;Elliosoid Distance: </span><span class="sc">{}</span><span class="st"> km&#39;</span>.<span class="bu">format</span>(ellipsoid_distance))</code></pre></div>
</div>
<div id="executing-a-script" class="section level2">
<h2>Executing a Script</h2>
<div id="windows" class="section level3">
<h3>Windows</h3>
<ol style="list-style-type: decimal">
<li>Launch the <em>Anaconda Navigator</em> program. Select the <code>python_foundation</code> environment and launch the <code>CMD.exe Prompt</code> program.</li>
</ol>
<p><img src="images/python_foundation/win_script1.png" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Navigate to the directory containing the script using the <code>cd</code> command.</li>
</ol>
<pre><code>cd Downloads\python_foundation</code></pre>
<p><img src="images/python_foundation/win_script2.png" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Run the script using the <code>python</code> command. The script will run and print the distance.</li>
</ol>
<pre><code>python get_distance.py</code></pre>
<p><img src="images/python_foundation/win_script3.png" style="display: block; margin: auto;" /></p>
</div>
<div id="mac-and-linux" class="section level3">
<h3>Mac and Linux</h3>
<ol style="list-style-type: decimal">
<li>Open a Terminal Window.</li>
</ol>
<p><img src="images/python_foundation/mac_script1.png" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Switch to the correct conda environment.</li>
</ol>
<pre><code>conda activate python_foundation</code></pre>
<p><img src="images/python_foundation/mac_script2.png" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Navigate to the directory containing the script using the <code>cd</code> command.</li>
</ol>
<pre><code>cd Downloads/python_foundation</code></pre>
<p><img src="images/python_foundation/mac_script3.png" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Run the script using the <code>python</code> command. The script will run and print the distance.</li>
</ol>
<blockquote>
<p>If you have multiple python installations on your system, you will have to pick the right Python binary. If the command fails, try <code>python3.7</code> instead of just <code>python</code> in the command below. The script will run and print the distance.</p>
</blockquote>
<pre><code>python get_distance.py</code></pre>
<p><img src="images/python_foundation/mac_script4.png" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<div id="what-next" class="section level1">
<h1>What next?</h1>
<p>To achieve mastery in programming, you need to practice writing code and solve many diverse type of problems. I strongly recommend picking up a project and implementing it in Python to improve your skills. You can also take other courses to learn aspects of Python and spatial data processing.</p>
<div id="do-a-project" class="section level2">
<h2>Do a Project</h2>
<p>I have some recommendation for projects that are a good fit for beginners, but are still challenging to help you become proficient. You can try to work on as many of the following problems as you like.</p>
<ul>
<li><strong>Geocoding</strong>: Find list of addresses and geocode them to create a point layer. Here’s a good overview of <a href="https://towardsdatascience.com/geocode-with-python-161ec1e62b89">geocoding using geopy</a></li>
<li><strong>Network Analysis</strong>: Use the <a href="https://github.com/gboeing/osmnx">osmnx package</a> to do network analysis with OpenStreetMap data and Python. Start by looking at <a href="https://github.com/gboeing/osmnx-examples/tree/master/notebooks">examples</a></li>
<li><strong>Geo-processing</strong>: I have several intermediate level geoprocessing tutorials that use QGIS. You can take any of the following tutorials and implement it using libraries such as <em>geopandas</em> and <em>rasterio</em>.
<ul>
<li><a href="https://www.qgistutorials.com/en/docs/3/performing_table_joins.html">Performing Table Joins</a></li>
<li><a href="https://www.qgistutorials.com/en/docs/3/performing_spatial_joins.html">Performing Spatial Joins</a></li>
<li><a href="https://www.qgistutorials.com/en/docs/3/performing_spatial_queries.html">Performing Spatial Queries</a></li>
<li><a href="https://www.qgistutorials.com/en/docs/3/nearest_neighbor_analysis.html">Nearest Neighbor Analysis</a></li>
<li><a href="https://www.qgistutorials.com/en/docs/3/sampling_raster_data.html">Sampling Raster Data using Points or Polygons</a></li>
</ul></li>
</ul>
</div>
<div id="keep-learning" class="section level2">
<h2>Keep Learning</h2>
<p>Here are some recommendations for courses you could take after you have completed this course.</p>
<ul>
<li>University of Helsinki’s Free <a href="https://geo-python.github.io/site/">Geo-Python Course</a></li>
<li>University of Helsinki’s Free <a href="https://automating-gis-processes.github.io/site/">Automating GIS Processes Course</a></li>
<li>Allen Downey’s Free <a href="https://allendowney.github.io/ElementsOfDataScience/">Elements of Data Science Course</a></li>
<li><a href="https://geopython.github.io/geopython-workshop/">Doing Geospatial in Python</a> online workshop. Covers some more geospatial libraries, with a focus on OGC services and metadata.</li>
</ul>

</div>
</div>
<div id="data-credits" class="section level1">
<h1>Data Credits</h1>
<ul>
<li><a href="https://simplemaps.com/data/world-cities">World Cities Database</a>: Basic database. Copyright SimpleMaps.com 2010-2020</li>
<li><a href="https://www.geonames.org">Geonames</a> places database for USA, Canada and Mexico</li>
<li>Karnataka Admin Boundaries: Downloaded from <a href="https://github.com/datameet/maps/tree/master/States">Datameet Spatial Data repository</a>.</li>
<li>OpenStreetMap (osm) data layers: Data/Maps Copyright 2019 Geofabrik GmbH and OpenStreetMap Contributors. <a href="https://download.geofabrik.de/asia/india.html">OSM India free extract</a> downloaded from Geofabrik.</li>
<li>Bangalore Sentinel-2 Imagery. Downloaded from <a href="https://scihub.copernicus.eu/">Copernicus Open Access Hub</a>. Copyright European Space Agency - ESA.</li>
<li>NASA Shuttle Radar Topography Mission (SRTM) Elevation Dataset. Downloaded from <a href="https://dwtkns.com/srtm30m/%5D">30m SRTM Tile Downloader</a>.</li>
</ul>
</div>
<div id="license" class="section level1">
<h1>License</h1>
<p>This course material is licensed under a <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>. You are free to use the material for any non-commercial purpose. Kindly give appropriate credit to the original author</p>
<p>If you would like to use this material for commercial use or for teaching a course, you can purchase a license. <a href="https://gum.co/mWcYL">Click to view and purchase on Gumroad</a>.</p>
<!--
This material is part of the *Trainer's Package* and the buyer gets a non-exclusive, non-transferable, perpetual license to the material. You can fully customise and brand the materials to your requirements.
-->
<p>© 2020 Ujaval Gandhi <a href="https://spatialthoughts.com">www.spatialthoughts.com</a></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
