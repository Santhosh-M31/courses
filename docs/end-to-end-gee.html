<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Ujaval Gandhi" />


<title>(DRAFT) End-to-End Google Earth Engine (Full Course Material)</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172372432-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-172372432-3');
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Courses</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="http://spatialthoughts.com">Back to Main Site</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">(DRAFT) End-to-End Google Earth Engine (Full Course Material)</h1>
<h3 class="subtitle">A hands-on introduction to applied remote sensing using Google Earth Engine.</h3>
<h4 class="author">Ujaval Gandhi</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#setting-up-the-environment">Setting up the Environment</a><ul>
<li><a href="#sign-up-for-google-earth-engine">Sign-up for Google Earth Engine</a></li>
<li><a href="#complete-the-class-pre-work">Complete the Class Pre-Work</a><ul>
<li><a href="#introduction-to-remote-sensing">Introduction to Remote Sensing</a></li>
<li><a href="#introduction-to-google-earth-engine">Introduction to Google Earth Engine</a></li>
<li><a href="#take-the-quiz">Take the Quiz</a></li>
</ul></li>
<li><a href="#get-the-course-materials">Get the Course Materials</a></li>
</ul></li>
<li><a href="#module-1-earth-engine-basics">Module 1: Earth Engine Basics</a><ul>
<li><a href="#hello-world">01. Hello World</a><ul>
<li><a href="#exercise">Exercise</a></li>
<li><a href="#saving-your-work">Saving Your Work</a></li>
</ul></li>
<li><a href="#working-with-image-collections">02. Working with Image Collections</a><ul>
<li><a href="#exercise-1">Exercise</a></li>
</ul></li>
<li><a href="#filtering-image-collections">03. Filtering Image Collections</a><ul>
<li><a href="#exercise-2">Exercise</a></li>
</ul></li>
<li><a href="#sorting-mosaicing-and-compositing-image-collections">04. Sorting, Mosaicing and Compositing Image Collections</a><ul>
<li><a href="#exercise-3">Exercise</a></li>
</ul></li>
<li><a href="#working-with-feature-collections">05. Working with Feature Collections</a><ul>
<li><a href="#exercise-4">Exercise</a></li>
</ul></li>
<li><a href="#importing-data">06. Importing Data</a><ul>
<li><a href="#exercise-5">Exercise</a></li>
</ul></li>
<li><a href="#clipping-images">07. Clipping Images</a><ul>
<li><a href="#exercise-6">Exercise</a></li>
</ul></li>
<li><a href="#exporting-data">08. Exporting Data</a><ul>
<li><a href="#exercise-7">Exercise</a></li>
</ul></li>
<li><a href="#assignment">Assignment</a></li>
</ul></li>
<li><a href="#what-next">What next?</a><ul>
<li><a href="#guided-project">Guided Project</a></li>
<li><a href="#resources">Resources</a></li>
</ul></li>
<li><a href="#data-credits">Data Credits</a></li>
<li><a href="#license">License</a></li>
</ul>
</div>


<hr />
<p><img src="images/spatial_thoughts_logo.png" width="250pt" style="display: block; margin: auto;" /></p>
<hr />

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Google Earth Engine is a cloud-based platform that enables large-scale processing of satellite imagery to detect changes, map trends, and quantify differences on the Earth’s surface. This course covers the full range of topics in Earth Engine to give the participants practical skills to master the platform and implement their remote sensing projects.</p>
<p><a href="https://docs.google.com/presentation/d/1q8HRDTqgQEp3Hmi8IG0T7djPLTC1wRig3jXrwFTmoVE/edit?usp=sharing" target="_blank"><img src="images/end_to_end_gee/course_overview.png" alt="View Presentation" width="300" /></a></p>
<p><a href="https://docs.google.com/presentation/d/1q8HRDTqgQEp3Hmi8IG0T7djPLTC1wRig3jXrwFTmoVE/edit?usp=sharing" target="_blank">View the Presentation</a></p>
</div>
<div id="setting-up-the-environment" class="section level1">
<h1>Setting up the Environment</h1>
<div id="sign-up-for-google-earth-engine" class="section level2">
<h2>Sign-up for Google Earth Engine</h2>
<p>If you already have a Google Earth Engine account, you can skip this step.</p>
<p>Visit <a href="https://signup.earthengine.google.com/" class="uri" target="_blank">https://signup.earthengine.google.com/</a> and sign-up with your Google account. You can use your existing gmail account to sign-up. It usually takes a 1-2 days for approval. Hence do this step as soon as possible.</p>
<p>Tips to ensure smooth sign-up process:</p>
<ul>
<li>Use Google Chrome browser.</li>
<li>When signing up for Earth Engine, please log out of all Google accounts and ensure you are logged into only 1 account which you want associated with Earth Engine.</li>
<li>Access to Google Earth Engine is granted via Google Groups. The default settings should be fine, but verify you have the correct setting enabled.
<ul>
<li>Visit <a href="http://groups.google.com/" target="_blank">groups.google.com</a></li>
<li>Click on Settings (gear icon) and select Global Settings.</li>
<li>Make sure the option Allow group managers to add me to their groups is checked.</li>
</ul></li>
</ul>
</div>
<div id="complete-the-class-pre-work" class="section level2">
<h2>Complete the Class Pre-Work</h2>
<p>This class needs about 2-hours of pre-work. Please watch the following videos to get a good understanding of remote sensing and how Earth Engine works. Videos are available online and can be streamed using video links below.</p>
<div id="introduction-to-remote-sensing" class="section level3">
<h3>Introduction to Remote Sensing</h3>
<p>This video introduces the remote sensing concepts, terminology and techniques.</p>
<p><a href="https://www.youtube.com/watch?v=xAyNu9HbK8s" target="_blank"><img src="images/end_to_end_gee/intro_to_remote_sensing.jpg" alt="Video" width="300" /></a></p>
<p><a href="https://docs.google.com/presentation/d/1opRKXIV8XSMa5h7Gqw10KXY5nW7_khfdiBmyDEcylUE/edit?usp=sharing" target="_blank">View the Presentation</a></p>
</div>
<div id="introduction-to-google-earth-engine" class="section level3">
<h3>Introduction to Google Earth Engine</h3>
<p>This video gives a broad overview of Google Earth Engine with selected case studies and application. The video also covers the Earth Engine architecture and how it is different than traditional remote sensing software.</p>
<p><a href="https://www.youtube.com/watch?v=kpfncBHZBto" target="_blank"><img src="images/end_to_end_gee/intro_to_gee.jpg" alt="Video" width="300" /></a></p>
<p><a href="https://docs.google.com/presentation/d/1RMyufK1bD7_Mj0b0Pub-CADiBsmT8LqyGMXIgem3UW4/edit?usp=sharing" target="_blank">View the Presentation</a></p>
</div>
<div id="take-the-quiz" class="section level3">
<h3>Take the Quiz</h3>
<p>After you watch the videos, please <a href="https://forms.gle/BoaYhMgpjwNn3amS8" target="_blank">take this quiz</a>.</p>
</div>
</div>
<div id="get-the-course-materials" class="section level2">
<h2>Get the Course Materials</h2>
<p>The course material and exercises are in the form of Earth Engine scripts shared via a code repository.</p>
<ol style="list-style-type: decimal">
<li><a href="https://code.earthengine.google.com/?accept_repo=users/ujavalgandhi/End-to-End-GEE">Click this link</a> to open Google Earth Engine code editor and add the repository to your account.</li>
<li>If successful, you will have a new repository named <code>users/ujavalgandhi/End-to-End-GEE</code> in the <em>Scripts</em> tab in the <em>Reader</em> section.</li>
<li>Verify that your code editor looks like below</li>
</ol>
<div class="figure" style="text-align: center">
<img src="images/end_to_end_gee/repository.png" alt="Code Editor After Adding the Class Repository" width="75%" />
<p class="caption">
Code Editor After Adding the Class Repository
</p>
</div>

</div>
</div>
<div id="module-1-earth-engine-basics" class="section level1">
<h1>Module 1: Earth Engine Basics</h1>
<p>Module 1 is designed to give you basic skills to be able to find datasets you need for your project, filter them to your region of interest, apply basic processing and export the results. Mastering this will allow you to start using Earth Engine for your project quickly and save a lot of time pre-processing the data.</p>
<div id="hello-world" class="section level2">
<h2>01. Hello World</h2>
<p>This script introduces the basic Javascript syntax. To learn more, visit <a href="https://developers.google.com/earth-engine/tutorials/tutorial_js_01">Introduction to JavaScript for Earth Engine</a> section of the Earth Engine User Guide.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="at">print</span>(<span class="st">&#39;Hello World&#39;</span>)<span class="op">;</span>

<span class="co">// Variables</span>
<span class="kw">var</span> city <span class="op">=</span> <span class="st">&#39;Bengaluru&#39;</span><span class="op">;</span>
<span class="kw">var</span> country <span class="op">=</span> <span class="st">&#39;India&#39;</span><span class="op">;</span>
<span class="at">print</span>(city<span class="op">,</span> country)<span class="op">;</span>

<span class="kw">var</span> population <span class="op">=</span> <span class="dv">8400000</span><span class="op">;</span>
<span class="at">print</span>(population)<span class="op">;</span>
 
<span class="co">// List</span>
<span class="kw">var</span> majorCities <span class="op">=</span> [<span class="st">&#39;Mumbai&#39;</span><span class="op">,</span> <span class="st">&#39;Delhi&#39;</span><span class="op">,</span> <span class="st">&#39;Chennai&#39;</span><span class="op">,</span> <span class="st">&#39;Kolkata&#39;</span>]<span class="op">;</span>
<span class="at">print</span>(majorCities)<span class="op">;</span>

<span class="co">// Dictionary</span>
<span class="kw">var</span> cityData <span class="op">=</span> <span class="op">{</span>
  <span class="st">&#39;city&#39;</span><span class="op">:</span> city<span class="op">,</span>
  <span class="st">&#39;population&#39;</span><span class="op">:</span> <span class="dv">8400000</span><span class="op">,</span>
  <span class="st">&#39;elevation&#39;</span><span class="op">:</span> <span class="dv">930</span>
<span class="op">};</span>
<span class="at">print</span>(cityData)<span class="op">;</span>

<span class="co">// Function</span>
<span class="kw">var</span> greet <span class="op">=</span> <span class="kw">function</span>(name) <span class="op">{</span>
    <span class="cf">return</span> <span class="st">&#39;Hello &#39;</span> <span class="op">+</span> name<span class="op">;</span>
<span class="op">};</span>
<span class="at">print</span>(<span class="at">greet</span>(<span class="st">&#39;World&#39;</span>))<span class="op">;</span>

<span class="co">// This is a comment</span></code></pre></div>
<div id="exercise" class="section level3">
<h3>Exercise</h3>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">// These are the 5 largest cities in the world: </span>
<span class="co">// Tokyo, Delhi, Shanghai, Mexico City, Sao Paulo</span>

<span class="co">// Create a list named &#39;largeCities&#39;</span>
<span class="co">// The list should have names of all the above cities</span>
<span class="co">// Print the list </span></code></pre></div>
</div>
<div id="saving-your-work" class="section level3">
<h3>Saving Your Work</h3>
<p>When you modify any script for the course repository, you may want to save a copy for yourself. If you try to click the <em>Save</em> button, you will get an error message like below</p>
<p><img src="images/end_to_end_gee/setup1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>This is because the shared class repository is a <em>Read-only</em> repository. You can click <em>Yes</em> to save a copy in your own repository. If this is the first time you are using Earth Engine, you will be prompted to choose the name of your <em>home folder</em>. Choose the name carefully, as it cannot be changed once created.</p>
<p><img src="images/end_to_end_gee/setup2.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="working-with-image-collections" class="section level2">
<h2>02. Working with Image Collections</h2>
<p>Most datasets in Earth Engine come as a <code>ImageCollection</code>. An ImageCollection is a dataset that consists of images takes at different time and locations - usually from the same satellite or data provider. You can load a collection by searching the <a href="https://developers.google.com/earth-engine/datasets">Earth Engine Data Catalog</a> for the <em>ImageCollection ID</em>. Search for the <em>Sentinel-2 Level 1C</em> dataset and you will find its id <code>COPERNICUS/S2_SR</code>.</p>
<p>Before you do anything with the collection, it is useful to see information about a single image contained in the collection. The <code>first()</code> function extracts the first image in the collection. You can then <code>print()</code> the result to see the bands and metadata contained in that image.</p>
<p>To see the collection on a map, we need to use <code>Map.addLayer()</code> function. But before that we need to know some parameters. The Earth Engine data catalog provides suggested visualization parameters for all collections. Visit the <a href="https://developers.google.com/earth-engine/datasets/catalog/COPERNICUS_S2">Sentinel-2, Level 1C page</a> and see <em>Explore in Earth Engine</em> section to find the visualization parameters. We can use these to add the collection to the map.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">/**</span>
<span class="co"> * Function to mask clouds using the Sentinel-2 QA band</span>
<span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="cv">{ee.Image}</span><span class="co"> image Sentinel-2 image</span>
<span class="co"> * </span><span class="an">@return</span><span class="co"> {ee.Image} cloud masked Sentinel-2 image</span>
<span class="co"> */</span>
<span class="kw">function</span> <span class="at">maskS2clouds</span>(image) <span class="op">{</span>
  <span class="kw">var</span> qa <span class="op">=</span> <span class="va">image</span>.<span class="at">select</span>(<span class="st">&#39;QA60&#39;</span>)<span class="op">;</span>

  <span class="co">// Bits 10 and 11 are clouds and cirrus, respectively.</span>
  <span class="kw">var</span> cloudBitMask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">10</span><span class="op">;</span>
  <span class="kw">var</span> cirrusBitMask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">11</span><span class="op">;</span>

  <span class="co">// Both flags should be set to zero, indicating clear conditions.</span>
  <span class="kw">var</span> mask <span class="op">=</span> <span class="va">qa</span>.<span class="at">bitwiseAnd</span>(cloudBitMask).<span class="at">eq</span>(<span class="dv">0</span>)
      .<span class="at">and</span>(<span class="va">qa</span>.<span class="at">bitwiseAnd</span>(cirrusBitMask).<span class="at">eq</span>(<span class="dv">0</span>))<span class="op">;</span>

  <span class="cf">return</span> <span class="va">image</span>.<span class="at">updateMask</span>(mask).<span class="at">divide</span>(<span class="dv">10000</span>)<span class="op">;</span>
<span class="op">}</span>

<span class="kw">var</span> dataset <span class="op">=</span> <span class="va">ee</span>.<span class="at">ImageCollection</span>(<span class="st">&#39;COPERNICUS/S2_SR&#39;</span>)
                  .<span class="at">filterDate</span>(<span class="st">&#39;2020-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-30&#39;</span>)
                  <span class="co">// Pre-filter to get less cloudy granules.</span>
                  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span><span class="dv">20</span>))
                  .<span class="at">map</span>(maskS2clouds)<span class="op">;</span>

<span class="kw">var</span> visualization <span class="op">=</span> <span class="op">{</span>
  <span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span>
  <span class="dt">max</span><span class="op">:</span> <span class="fl">0.3</span><span class="op">,</span>
  <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span>
<span class="op">};</span>

<span class="va">Map</span>.<span class="at">setCenter</span>(<span class="fl">77.5925</span><span class="op">,</span> <span class="fl">12.9407</span><span class="op">,</span> <span class="dv">12</span>)<span class="op">;</span>

<span class="va">Map</span>.<span class="at">addLayer</span>(<span class="va">dataset</span>.<span class="at">mean</span>()<span class="op">,</span> visualization<span class="op">,</span> <span class="st">&#39;RGB&#39;</span>)<span class="op">;</span></code></pre></div>
<div id="exercise-1" class="section level3">
<h3>Exercise</h3>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">// Find the &#39;Sentinel-2 Level-2A&#39; dataset page</span>
<span class="co">// https://developers.google.com/earth-engine/datasets</span>

<span class="co">// Copy/page the code snippet</span>

<span class="co">// Change the code to display images for your home city</span></code></pre></div>
</div>
</div>
<div id="filtering-image-collections" class="section level2">
<h2>03. Filtering Image Collections</h2>
<p>The collection contains all imagery ever collected by the sensor. The entire collections are not very useful. Most applications require a subset of the images. We use <strong>filters</strong> to select the appropriate images. There are many types of filter functions, look at <code>ee.Filter...</code> module to see all available filters. Select a filter and then run the <code>filter()</code> function with the filter parameters.</p>
<p>We will learn about 3 main types of filtering techniques</p>
<ul>
<li>Filter by metadata: You can apply a filter on the image metadata using filters such as <code>ee.Filter.eq()</code>, <code>ee.Filter.lt()</code> etc. You can filter by PATH/ROW values, Orbit number, Cloud cover etc.</li>
<li>Filter by date: You can select images in a particular date range using filters such as <code>ee.Filter.date()</code>.</li>
<li>Filter by location: You can select the subset of images with a bounding box, location or geometry using the <code>ee.Filter.bounds()</code>. You can also use the drawing tools to draw a geometry for filtering.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> geometry <span class="op">=</span> <span class="va">ee</span>.<span class="va">Geometry</span>.<span class="at">Point</span>([<span class="fl">77.60412933051538</span><span class="op">,</span> <span class="fl">12.952912912328241</span>])
<span class="kw">var</span> s2 <span class="op">=</span> <span class="va">ee</span>.<span class="at">ImageCollection</span>(<span class="st">&quot;COPERNICUS/S2&quot;</span>)<span class="op">;</span>

<span class="co">// Filter by metadata</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">s2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))

<span class="co">// Filter by date</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">s2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">date</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-01&#39;</span>))

<span class="co">// Filter by location</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">s2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">bounds</span>(geometry))

<span class="co">// Instead of applying filters one after the other, we can &#39;chain&#39; them</span>
<span class="co">// Use the . notation to apply all the filters together</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">s2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">date</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-01&#39;</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">bounds</span>(geometry))
  
<span class="at">print</span>(<span class="va">filtered</span>.<span class="at">size</span>())

<span class="kw">var</span> rgbVis <span class="op">=</span> <span class="op">{</span>
  <span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span>
  <span class="dt">max</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span>
  <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span>
<span class="op">};</span>
<span class="va">Map</span>.<span class="at">addLayer</span>(filtered<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;Filtered&#39;</span>) </code></pre></div>
<div id="exercise-2" class="section level3">
<h3>Exercise</h3>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> geometry <span class="op">=</span> <span class="va">ee</span>.<span class="va">Geometry</span>.<span class="at">Point</span>([<span class="fl">77.60412933051538</span><span class="op">,</span> <span class="fl">12.952912912328241</span>])
<span class="kw">var</span> s2 <span class="op">=</span> <span class="va">ee</span>.<span class="at">ImageCollection</span>(<span class="st">&quot;COPERNICUS/S2&quot;</span>)<span class="op">;</span>
<span class="co">// Add one more filter that only shows image from the satellite</span>
<span class="co">// Sentinel-2A</span>
<span class="co">// Hint1: Use the &#39;SPACECRAFT_NAME&#39; property</span>
<span class="co">// Hint2: Use the ee.Filter.eq() filter</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">s2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">date</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-01&#39;</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">bounds</span>(geometry))
<span class="at">print</span>(<span class="va">filtered</span>.<span class="at">size</span>())

<span class="kw">var</span> rgbVis <span class="op">=</span> <span class="op">{</span>
  <span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span>
  <span class="dt">max</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span>
  <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span>
<span class="op">};</span>
<span class="va">Map</span>.<span class="at">addLayer</span>(filtered<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;Filtered&#39;</span>)  </code></pre></div>
</div>
</div>
<div id="sorting-mosaicing-and-compositing-image-collections" class="section level2">
<h2>04. Sorting, Mosaicing and Compositing Image Collections</h2>
<p>The default order of the collection is by date. So when you display the the collection, it implicitely creates a mosaic with the latest pixels in top. You can call <code>.mosaic()</code> on a ImageCollection to create a mosaic image from the pixels at the top.</p>
<p>We can sort the collection differently before mosaicing using the <code>sort()</code> function. Here we create a mosaic with the most cloud-free image on top.</p>
<p>We can also create composite image by applying a selection criteria to each pixel from all pixels in the stack. Here we use the <code>median()</code> function to create a composite where each pixel value is the median of all pixels from the stack.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> geometry <span class="op">=</span> <span class="va">ee</span>.<span class="va">Geometry</span>.<span class="at">Point</span>([<span class="fl">77.60412933051538</span><span class="op">,</span> <span class="fl">12.952912912328241</span>])
<span class="kw">var</span> s2 <span class="op">=</span> <span class="va">ee</span>.<span class="at">ImageCollection</span>(<span class="st">&quot;COPERNICUS/S2&quot;</span>)<span class="op">;</span>

<span class="kw">var</span> rgbVis <span class="op">=</span> <span class="op">{</span>
  <span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span>
  <span class="dt">max</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span>
  <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span>
<span class="op">};</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">s2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">date</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-01&#39;</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">bounds</span>(geometry))
 
<span class="kw">var</span> mosaic <span class="op">=</span> <span class="va">filtered</span>.<span class="at">mosaic</span>() 
 
<span class="kw">var</span> leastCloudyMosaic <span class="op">=</span> <span class="va">filtered</span>.<span class="at">sort</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="kw">false</span>).<span class="at">mosaic</span>()<span class="op">;</span>

<span class="kw">var</span> medianComposite <span class="op">=</span> <span class="va">filtered</span>.<span class="at">median</span>()<span class="op">;</span>

<span class="va">Map</span>.<span class="at">addLayer</span>(filtered<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;Filtered Collection&#39;</span>)<span class="op">;</span>
<span class="va">Map</span>.<span class="at">addLayer</span>(mosaic<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;Filtered Collection&#39;</span>)<span class="op">;</span>
<span class="va">Map</span>.<span class="at">addLayer</span>(leastCloudyMosaic<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;Least Cloudy Mosaic&#39;</span>)<span class="op">;</span>
<span class="va">Map</span>.<span class="at">addLayer</span>(medianComposite<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;Median Composite&#39;</span>)</code></pre></div>
<div id="exercise-3" class="section level3">
<h3>Exercise</h3>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> geometry <span class="op">=</span> <span class="va">ee</span>.<span class="va">Geometry</span>.<span class="at">Point</span>([<span class="fl">77.60412933051538</span><span class="op">,</span> <span class="fl">12.952912912328241</span>])
<span class="kw">var</span> s2 <span class="op">=</span> <span class="va">ee</span>.<span class="at">ImageCollection</span>(<span class="st">&quot;COPERNICUS/S2&quot;</span>)<span class="op">;</span>

<span class="kw">var</span> rgbVis <span class="op">=</span> <span class="op">{</span>
  <span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span>
  <span class="dt">max</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span>
  <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span> 
<span class="op">};</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">s2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">date</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-01&#39;</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">bounds</span>(geometry))

<span class="kw">var</span> image2019 <span class="op">=</span> <span class="va">filtered</span>.<span class="at">median</span>()<span class="op">;</span>
<span class="va">Map</span>.<span class="at">addLayer</span>(image2019<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;2019&#39;</span>)

<span class="co">// Create a median composite for 2020 and load it to the map</span></code></pre></div>
</div>
</div>
<div id="working-with-feature-collections" class="section level2">
<h2>05. Working with Feature Collections</h2>
<p>Feature Collections are similar to Image Collections - but they contain <em>Features</em>, not images. They are equivalent to Vector Layers in a GIS. We can load, filter and display Feature Collections using similar techniques that we have learnt so far.</p>
<p>Search for <em>GAUL Second Level Administrative Boundaries</em> and load the collection. This is a global collection that contain all Admin2 boundaries. We can apply a filter using the <code>ADM1_NAME</code> property to get all Admin2 boundaries (i.e. Districts) from a state.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> admin2 <span class="op">=</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>(<span class="st">&quot;FAO/GAUL_SIMPLIFIED_500m/2015/level2&quot;</span>)<span class="op">;</span>

<span class="kw">var</span> karnataka <span class="op">=</span> <span class="va">admin2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">eq</span>(<span class="st">&#39;ADM1_NAME&#39;</span><span class="op">,</span> <span class="st">&#39;Karnataka&#39;</span>))

<span class="kw">var</span> visParams <span class="op">=</span> <span class="op">{</span><span class="st">&#39;color&#39;</span><span class="op">:</span> <span class="st">&#39;red&#39;</span><span class="op">}</span>
<span class="va">Map</span>.<span class="at">addLayer</span>(karnataka<span class="op">,</span> visParams<span class="op">,</span> <span class="st">&#39;Karnataka Districts&#39;</span>)</code></pre></div>
<div id="exercise-4" class="section level3">
<h3>Exercise</h3>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> admin2 <span class="op">=</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>(<span class="st">&quot;FAO/GAUL_SIMPLIFIED_500m/2015/level2&quot;</span>)<span class="op">;</span>
<span class="kw">var</span> karnataka <span class="op">=</span> <span class="va">admin2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">eq</span>(<span class="st">&#39;ADM1_NAME&#39;</span><span class="op">,</span> <span class="st">&#39;Karnataka&#39;</span>))

<span class="co">// Apply a filter to select only the &#39;Bangalore Urban&#39; district</span>
<span class="co">// Display only the selected district</span>
<span class="co">// Hint: The district names are in ADM2_NAME property</span>
<span class="kw">var</span> visParams <span class="op">=</span> <span class="op">{</span><span class="st">&#39;color&#39;</span><span class="op">:</span> <span class="st">&#39;red&#39;</span><span class="op">}</span></code></pre></div>
</div>
</div>
<div id="importing-data" class="section level2">
<h2>06. Importing Data</h2>
<p>You can import vector or raster data into Earth Engine. We will now import a shapefile of <a href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-urban-area/">Urban Areas</a> for Natural Earth. Unzip the <code>ne_10m_urban_areas.zip</code> into a folder on your computer. In the Code Editor, go to <em>Assets → New → Table Upload → Shape Files</em>. Select the <code>.shp</code>, <code>.shx</code>, <code>.dbf</code> and .<code>prj</code> files. Enter <code>ne_10m_urban_areas</code> as the <em>Asset Name</em> and click <em>Upload</em>. Once the upload and ingest finishes, you will have a new asset in the <em>Assets</em> tab. The shapefile is imported as a Feature Collection in Earth Engine. Select the <code>ne_10m_urban_areas</code> asset and click <em>Import</em>. You can then visualize the imported data.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">// Let&#39;s import some data to Earth Engine</span>
<span class="co">// Upload the ne_10m_urban_areas.shp shapefile</span>

<span class="co">// Import the collection</span>
<span class="kw">var</span> urban <span class="op">=</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>(<span class="st">&quot;users/ujavalgandhi/e2e/ne_10m_urban_areas&quot;</span>)<span class="op">;</span>

<span class="co">// Visualize the collection</span>
<span class="va">Map</span>.<span class="at">addLayer</span>(urban<span class="op">,</span> <span class="op">{</span><span class="dt">color</span><span class="op">:</span> <span class="st">&#39;blue&#39;</span><span class="op">},</span> <span class="st">&#39;Urban Areas&#39;</span>)</code></pre></div>
<div id="exercise-5" class="section level3">
<h3>Exercise</h3>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> urban <span class="op">=</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>(<span class="st">&quot;users/ujavalgandhi/e2e/ne_10m_urban_areas&quot;</span>)<span class="op">;</span>

<span class="co">// Apply a filter to select only large urban areas</span>
<span class="co">// Use the property &#39;area_sqkm&#39; and select all features </span>
<span class="co">// with area &gt; 400 sq.km</span></code></pre></div>
</div>
</div>
<div id="clipping-images" class="section level2">
<h2>07. Clipping Images</h2>
<p>It is often desirable to clip the images to your area of interest. You can use the <code>clip()</code> function to mask out an image using a geometry.</p>
<blockquote>
<p>While in a Desktop software, clipping is desirable to remove unneccesary portion of a large image and save computation time, in Earth Engine clipping can actually increase the computation time. As described in the <a href="https://developers.google.com/earth-engine/guides/best_practices?hl=en#if-you-dont-need-to-clip,-dont-use-clip">Earth Engine Coding Best Practices</a> guide, avoid clipping the images or do it at the end of your script.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> s2 <span class="op">=</span> <span class="va">ee</span>.<span class="at">ImageCollection</span>(<span class="st">&quot;COPERNICUS/S2&quot;</span>)
<span class="kw">var</span> urban <span class="op">=</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>(<span class="st">&quot;users/ujavalgandhi/e2e/ne_10m_urban_areas&quot;</span>)

<span class="co">// Find the feature id by adding the layer to the map and using Inspector.</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">urban</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">eq</span>(<span class="st">&#39;system:index&#39;</span><span class="op">,</span> <span class="st">&#39;00000000000000002bf8&#39;</span>))

<span class="kw">var</span> geometry <span class="op">=</span> <span class="va">filtered</span>.<span class="at">geometry</span>()

<span class="kw">var</span> rgbVis <span class="op">=</span> <span class="op">{</span>
  <span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span>
  <span class="dt">max</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span>
  <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span> 
<span class="op">};</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">s2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">date</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-01&#39;</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">bounds</span>(geometry))

<span class="kw">var</span> image <span class="op">=</span> <span class="va">filtered</span>.<span class="at">median</span>()<span class="op">;</span> 

<span class="kw">var</span> clipped <span class="op">=</span> <span class="va">image</span>.<span class="at">clip</span>(geometry)

<span class="va">Map</span>.<span class="at">addLayer</span>(clipped<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;Clipped&#39;</span>)</code></pre></div>
<div id="exercise-6" class="section level3">
<h3>Exercise</h3>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> s2 <span class="op">=</span> <span class="va">ee</span>.<span class="at">ImageCollection</span>(<span class="st">&quot;COPERNICUS/S2&quot;</span>)
<span class="kw">var</span> urban <span class="op">=</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>(<span class="st">&quot;users/ujavalgandhi/e2e/ne_10m_urban_areas&quot;</span>)

<span class="co">// Change the filter to your home city or any urban area of your choice</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">urban</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">eq</span>(<span class="st">&#39;system:index&#39;</span><span class="op">,</span> <span class="st">&#39;00000000000000002bf8&#39;</span>))
<span class="kw">var</span> geometry <span class="op">=</span> <span class="va">filtered</span>.<span class="at">geometry</span>()

<span class="kw">var</span> rgbVis <span class="op">=</span> <span class="op">{</span>
  <span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span>
  <span class="dt">max</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span>
  <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span> 
<span class="op">};</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">s2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">date</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2019-12-31&#39;</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">bounds</span>(geometry))

<span class="kw">var</span> image <span class="op">=</span> <span class="va">filtered</span>.<span class="at">median</span>()<span class="op">;</span> 

<span class="kw">var</span> clipped <span class="op">=</span> <span class="va">image</span>.<span class="at">clip</span>(geometry)

<span class="va">Map</span>.<span class="at">addLayer</span>(clipped<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;Clipped&#39;</span>)</code></pre></div>
</div>
</div>
<div id="exporting-data" class="section level2">
<h2>08. Exporting Data</h2>
<p>Earth Engine allows for exporting both vector and raster data to be used in an external program. Vector data can be exported as a <code>CSV</code> or a <code>Shapefile</code>, while Rasters can be exported as <code>GeoTIFF</code> files. We will now export the Sentinel-2 Composite as a GeoTIFF file.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> s2 <span class="op">=</span> <span class="va">ee</span>.<span class="at">ImageCollection</span>(<span class="st">&quot;COPERNICUS/S2&quot;</span>)
<span class="kw">var</span> urban <span class="op">=</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>(<span class="st">&quot;users/ujavalgandhi/e2e/ne_10m_urban_areas&quot;</span>)

<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">urban</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">eq</span>(<span class="st">&#39;system:index&#39;</span><span class="op">,</span> <span class="st">&#39;00000000000000002bf8&#39;</span>))
<span class="kw">var</span> geometry <span class="op">=</span> <span class="va">filtered</span>.<span class="at">geometry</span>()

<span class="kw">var</span> rgbVis <span class="op">=</span> <span class="op">{</span>
  <span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span>
  <span class="dt">max</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span>
  <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span> 
<span class="op">};</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">s2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">date</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-01&#39;</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">bounds</span>(geometry))

<span class="kw">var</span> image <span class="op">=</span> <span class="va">filtered</span>.<span class="at">median</span>()<span class="op">;</span> 

<span class="kw">var</span> clipped <span class="op">=</span> <span class="va">image</span>.<span class="at">clip</span>(geometry)

<span class="va">Map</span>.<span class="at">addLayer</span>(clipped<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;Clipped&#39;</span>) 

<span class="kw">var</span> exportImage <span class="op">=</span> <span class="va">clipped</span>.<span class="at">select</span>(<span class="st">&#39;B.*&#39;</span>)

<span class="va">Export</span>.<span class="va">image</span>.<span class="at">toDrive</span>(<span class="op">{</span>
    <span class="dt">image</span><span class="op">:</span> exportImage<span class="op">,</span>
    <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;Bangalore_Composite&#39;</span><span class="op">,</span>
    <span class="dt">folder</span><span class="op">:</span> <span class="st">&#39;earthengine&#39;</span><span class="op">,</span>
    <span class="dt">fileNamePrefix</span><span class="op">:</span> <span class="st">&#39;bangalore_composite&#39;</span><span class="op">,</span>
    <span class="dt">region</span><span class="op">:</span> geometry<span class="op">,</span>
    <span class="dt">scale</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span>
    <span class="dt">maxPixels</span><span class="op">:</span> <span class="fl">1e9</span>
<span class="op">}</span>)</code></pre></div>
<div id="exercise-7" class="section level3">
<h3>Exercise</h3>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> s2 <span class="op">=</span> <span class="va">ee</span>.<span class="at">ImageCollection</span>(<span class="st">&quot;COPERNICUS/S2&quot;</span>)
<span class="kw">var</span> urban <span class="op">=</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>(<span class="st">&quot;users/ujavalgandhi/e2e/ne_10m_urban_areas&quot;</span>)

<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">urban</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">eq</span>(<span class="st">&#39;system:index&#39;</span><span class="op">,</span> <span class="st">&#39;00000000000000002bf8&#39;</span>))
<span class="kw">var</span> geometry <span class="op">=</span> <span class="va">filtered</span>.<span class="at">geometry</span>()

<span class="kw">var</span> rgbVis <span class="op">=</span> <span class="op">{</span>
  <span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span>
  <span class="dt">max</span><span class="op">:</span> <span class="dv">3000</span><span class="op">,</span>
  <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span> 
<span class="op">};</span>
<span class="kw">var</span> filtered <span class="op">=</span> <span class="va">s2</span>.<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">lt</span>(<span class="st">&#39;CLOUDY_PIXEL_PERCENTAGE&#39;</span><span class="op">,</span> <span class="dv">30</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">date</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-01&#39;</span>))
  .<span class="at">filter</span>(<span class="va">ee</span>.<span class="va">Filter</span>.<span class="at">bounds</span>(geometry))

<span class="kw">var</span> image <span class="op">=</span> <span class="va">filtered</span>.<span class="at">median</span>()<span class="op">;</span> 

<span class="kw">var</span> clipped <span class="op">=</span> <span class="va">image</span>.<span class="at">clip</span>(geometry)

<span class="va">Map</span>.<span class="at">addLayer</span>(clipped<span class="op">,</span> rgbVis<span class="op">,</span> <span class="st">&#39;Clipped&#39;</span>) 

<span class="co">// Rather than exporting raw bands, we can apply a rendered image</span>
<span class="co">// visualize() function allows you to apply the same parameters </span>
<span class="co">// that are used in earth engine which exports a 3-band RGB image</span>
<span class="kw">var</span> visualized <span class="op">=</span> <span class="va">clipped</span>.<span class="at">visualize</span>(rgbVis)

<span class="co">// Export the visualized image</span></code></pre></div>
</div>
</div>
<div id="assignment" class="section level2">
<h2>Assignment</h2>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">// Assignment</span>
<span class="co">// Export the Night Lights images for May,2015 and May,2020</span>

<span class="co">// Workflow:</span>
<span class="co">// Load the VIIRS Nighttime Day/Night Band Composites collection</span>
<span class="co">// Filter the collection to the date range</span>
<span class="co">// Extract the &#39;avg_rad&#39; band which represents the nighttime lights</span>
<span class="co">// Clip the image to the geometry of your city</span>
<span class="co">// Export the resulting image as a GeoTIFF file.</span>

<span class="co">// Hint1: </span>

<span class="co">// There are 2 VIIRS Nighttime Day/Night collections</span>
<span class="co">// Use the one that corrects for stray light</span>

<span class="co">// Hint2: </span>

<span class="co">// The collection contains 1 global image per month</span>
<span class="co">// After filtering for the month, there will be only 1 image in the collection</span>

<span class="co">// You can use the following technique to extract that image</span>
<span class="co">// var image = ee.Image(filtered.first())</span></code></pre></div>

</div>
</div>
<div id="what-next" class="section level1">
<h1>What next?</h1>
<div id="guided-project" class="section level2">
<h2>Guided Project</h2>
</div>
<div id="resources" class="section level2">
<h2>Resources</h2>

</div>
</div>
<div id="data-credits" class="section level1">
<h1>Data Credits</h1>
</div>
<div id="license" class="section level1">
<h1>License</h1>
<p>This course material is licensed under a <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>. You are free to use the material for any non-commercial purpose. Kindly give appropriate credit to the original author.</p>
<!--
This material is part of the *Trainer's Package* and the buyer gets a non-exclusive, non-transferable, perpetual license to the material. You can fully customise and brand the materials to your requirements.
-->
<p>© 2020 Ujaval Gandhi <a href="https://spatialthoughts.com">www.spatialthoughts.com</a></p>
<hr />
<p><strong>This course is offered as an instructor-led online class. Visit <a href="https://spatialthoughts.com/events/">Spatial Thoughts</a> to know details of upcoming sessions.</strong></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
